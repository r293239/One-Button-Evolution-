<!DOCTYPE html>
<html>
<head>
    <title>Smart Auto Scan v2.0</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #e2e8f0;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(30, 41, 59, 0.8);
            border-radius: 15px;
            border: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        h1 {
            font-size: 2.5rem;
            color: #60a5fa;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #94a3b8;
        }
        
        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        #urlInput {
            flex: 1;
            padding: 15px;
            font-size: 16px;
            border: 2px solid #475569;
            border-radius: 10px;
            background: #1e293b;
            color: #e2e8f0;
        }
        
        #urlInput:focus {
            outline: none;
            border-color: #60a5fa;
        }
        
        .scan-btn {
            width: 100%;
            padding: 20px;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-bottom: 20px;
            transition: all 0.3s;
        }
        
        .scan-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(16, 185, 129, 0.3);
        }
        
        .scan-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }
        
        .scan-btn.stop {
            background: linear-gradient(135deg, #ef4444, #b91c1c);
        }
        
        .results {
            background: rgba(30, 41, 59, 0.8);
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
            border: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        .results h2 {
            color: #60a5fa;
            margin-bottom: 20px;
        }
        
        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .result-card {
            background: rgba(15, 23, 42, 0.8);
            border: 2px solid #475569;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s;
        }
        
        .result-card.working {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }
        
        .result-card.failed {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
            opacity: 0.7;
        }
        
        .result-card.testing {
            border-color: #f59e0b;
            background: rgba(245, 158, 11, 0.1);
        }
        
        .result-status {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .result-name {
            font-size: 1.1rem;
            color: #e2e8f0;
        }
        
        .result-desc {
            font-size: 0.9rem;
            color: #94a3b8;
            margin-top: 5px;
        }
        
        .use-btn {
            width: 100%;
            padding: 10px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 5px;
            margin-top: 10px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .use-btn:hover {
            background: #2563eb;
        }
        
        .progress-container {
            margin: 20px 0;
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #475569;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #3b82f6);
            width: 0%;
            transition: width 0.3s;
        }
        
        .log-box {
            background: rgba(15, 23, 42, 0.8);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
            border: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        .log-entry {
            margin-bottom: 5px;
            padding: 5px 0;
            border-bottom: 1px solid rgba(148, 163, 184, 0.1);
        }
        
        .success { color: #10b981; }
        .error { color: #ef4444; }
        .info { color: #60a5fa; }
        .warning { color: #f59e0b; }
        
        .stats {
            display: flex;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .stat {
            background: rgba(30, 41, 59, 0.8);
            padding: 15px;
            border-radius: 10px;
            flex: 1;
            min-width: 120px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #60a5fa;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #94a3b8;
        }
        
        .direct-result {
            background: rgba(139, 92, 246, 0.2);
            border: 2px solid #8b5cf6;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        @media (max-width: 600px) {
            .search-box {
                flex-direction: column;
            }
            
            .result-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ü§ñ Smart Auto Scan v2.0</h1>
            <p class="subtitle">Tests DIRECT first, then all proxy methods</p>
        </header>
        
        <div class="search-box">
            <input type="text" id="urlInput" placeholder="Enter website URL (e.g., youtube.com)" value="youtube.com">
        </div>
        
        <button class="scan-btn" id="scanBtn">üöÄ START SMART SCAN</button>
        
        <div class="stats">
            <div class="stat">
                <div class="stat-value" id="totalMethods">0</div>
                <div class="stat-label">Total Methods</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="testedMethods">0</div>
                <div class="stat-label">Tested</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="workingMethods">0</div>
                <div class="stat-label">Working</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="directResult">‚ùì</div>
                <div class="stat-label">Direct Test</div>
            </div>
        </div>
        
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div id="progressText" style="text-align:center;margin-top:5px;color:#94a3b8;">
                Ready to scan...
            </div>
        </div>
        
        <div class="results" id="resultsSection" style="display:none;">
            <h2>üìä Scan Results</h2>
            <div id="directResultSection"></div>
            <div class="result-grid" id="resultsGrid">
                <!-- Results appear here -->
            </div>
        </div>
        
        <div class="log-box" id="logBox">
            <div class="log-entry info">System ready. Enter URL and click START SMART SCAN.</div>
        </div>
    </div>

    <script>
        // ============ SMART METHOD LIBRARY ============
        const SMART_METHODS = [
            // PHASE 1: Direct Methods (Tested First)
            {
                id: 'direct',
                name: 'Direct Connection',
                icon: 'üéØ',
                category: 'direct',
                description: 'No proxy, connects directly',
                phase: 1,
                execute: function(url) {
                    return [url]; // Just the direct URL
                }
            },
            {
                id: 'direct-window',
                name: 'Direct Window',
                icon: 'ü™ü',
                category: 'direct',
                description: 'Direct window.open()',
                phase: 1,
                execute: function(url) {
                    return [url];
                }
            },
            
            // PHASE 2: Reliable Proxies (Tested if direct fails)
            {
                id: 'translate',
                name: 'Google Translate',
                icon: 'üåê',
                category: 'proxy',
                description: 'Google Translate proxy',
                phase: 2,
                execute: function(url) {
                    return [
                        `https://translate.google.com/translate?hl=en&sl=auto&tl=en&u=${encodeURIComponent(url)}`
                    ];
                }
            },
            {
                id: 'archive',
                name: 'Wayback Machine',
                icon: 'üìö',
                category: 'archive',
                description: 'Cached versions',
                phase: 2,
                execute: function(url) {
                    return [
                        `https://web.archive.org/web/${url}`,
                        `https://archive.is/${url}`
                    ];
                }
            },
            
            // PHASE 3: Alternative Proxies
            {
                id: 'mobile',
                name: 'Mobile View',
                icon: 'üì±',
                category: 'mobile',
                description: 'Mobile version',
                phase: 3,
                execute: function(url) {
                    const clean = url.replace('https://', '').replace('http://', '');
                    return [
                        `https://m.${clean}`,
                        `https://mobile.${clean}`
                    ];
                }
            },
            {
                id: 'reader',
                name: 'Reader View',
                icon: 'üìñ',
                category: 'reader',
                description: 'Clean reading mode',
                phase: 3,
                execute: function(url) {
                    const clean = url.replace('https://', '').replace('http://', '');
                    return [
                        `https://outline.com/${clean}`
                    ];
                }
            },
            
            // PHASE 4: Advanced Methods
            {
                id: 'public-proxy',
                name: 'Public Proxy',
                icon: 'üîÑ',
                category: 'proxy',
                description: 'Public proxy API',
                phase: 4,
                execute: function(url) {
                    return [
                        `https://corsproxy.io/?${encodeURIComponent(url)}`,
                        `https://api.allorigins.win/get?url=${encodeURIComponent(url)}`
                    ];
                }
            },
            {
                id: 'textise',
                name: 'Textise Pro',
                icon: 'üìÑ',
                category: 'text',
                description: 'Text-only render',
                phase: 4,
                execute: function(url) {
                    const clean = url.replace('https://', '').replace('http://', '');
                    return [
                        `https://r.jina.ai/http://${clean}`
                    ];
                }
            }
        ];

        // ============ STATE ============
        let scanActive = false;
        let scanResults = {};
        let currentPhase = 1;
        let directTestResult = null;
        let stats = {
            total: SMART_METHODS.length,
            tested: 0,
            working: 0
        };

        // ============ DOM ELEMENTS ============
        const elements = {
            urlInput: document.getElementById('urlInput'),
            scanBtn: document.getElementById('scanBtn'),
            resultsSection: document.getElementById('resultsSection'),
            resultsGrid: document.getElementById('resultsGrid'),
            logBox: document.getElementById('logBox'),
            progressFill: document.getElementById('progressFill'),
            progressText: document.getElementById('progressText'),
            directResultSection: document.getElementById('directResultSection')
        };

        // ============ LOGGING ============
        function log(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            elements.logBox.prepend(entry);
            if (elements.logBox.children.length > 50) {
                elements.logBox.removeChild(elements.logBox.lastChild);
            }
        }

        function updateProgress(phase, methodIndex, totalMethods) {
            const phaseWeight = phase * 0.25; // Each phase is 25%
            const methodProgress = (methodIndex / totalMethods) * 0.25;
            const progress = ((phase - 1) * 0.25 + methodProgress) * 100;
            
            elements.progressFill.style.width = progress + '%';
            
            let phaseText = '';
            switch(phase) {
                case 1: phaseText = 'Testing Direct Connection...'; break;
                case 2: phaseText = 'Testing Reliable Proxies...'; break;
                case 3: phaseText = 'Testing Alternative Methods...'; break;
                case 4: phaseText = 'Testing Advanced Methods...'; break;
            }
            
            elements.progressText.textContent = `${Math.round(progress)}% - ${phaseText}`;
        }

        function updateStats() {
            document.getElementById('totalMethods').textContent = stats.total;
            document.getElementById('testedMethods').textContent = stats.tested;
            document.getElementById('workingMethods').textContent = stats.working;
            
            if (directTestResult !== null) {
                const directEl = document.getElementById('directResult');
                directEl.textContent = directTestResult ? '‚úÖ' : '‚ùå';
                directEl.style.color = directTestResult ? '#10b981' : '#ef4444';
            }
        }

        // ============ SMART TEST FUNCTION ============
        async function smartTestMethod(method, url) {
            return new Promise((resolve) => {
                log(`Testing ${method.name}...`, 'info');
                
                const testId = `${method.id}_${Date.now()}`;
                const urls = method.execute(url);
                let tested = 0;
                let success = false;
                let workingUrl = null;
                
                urls.forEach((testUrl, index) => {
                    setTimeout(async () => {
                        if (success) return;
                        
                        tested++;
                        log(`  ‚Üí ${method.name} attempt ${index + 1}`, 'info');
                        
                        try {
                            // Special handling for direct methods
                            if (method.category === 'direct') {
                                // Test if we can directly access
                                const canAccess = await testDirectAccess(testUrl);
                                
                                if (canAccess) {
                                    success = true;
                                    workingUrl = testUrl;
                                    log(`  ‚úÖ ${method.name} WORKS DIRECTLY!`, 'success');
                                    resolve({
                                        method: method,
                                        working: true,
                                        url: workingUrl,
                                        direct: true
                                    });
                                } else {
                                    log(`  ‚ùå ${method.name} blocked`, 'error');
                                    if (tested === urls.length && !success) {
                                        resolve({
                                            method: method,
                                            working: false,
                                            direct: true
                                        });
                                    }
                                }
                                
                            } else {
                                // Proxy methods - test window opening
                                const win = window.open(testUrl, `test_${testId}_${index}`, 'width=500,height=400,left=100,top=100');
                                
                                setTimeout(() => {
                                    if (win && !win.closed) {
                                        success = true;
                                        workingUrl = testUrl;
                                        win.close();
                                        log(`  ‚úÖ ${method.name} WORKS via proxy!`, 'success');
                                        resolve({
                                            method: method,
                                            working: true,
                                            url: workingUrl,
                                            direct: false
                                        });
                                    } else if (tested === urls.length && !success) {
                                        log(`  ‚ùå ${method.name} failed`, 'error');
                                        resolve({
                                            method: method,
                                            working: false,
                                            direct: false
                                        });
                                    }
                                }, 3000); // Longer timeout for proxies
                            }
                            
                        } catch (error) {
                            log(`  ‚ùå ${method.name} error: ${error.message}`, 'error');
                            if (tested === urls.length && !success) {
                                resolve({
                                    method: method,
                                    working: false,
                                    direct: method.category === 'direct'
                                });
                            }
                        }
                    }, index * 4000); // 4 seconds between attempts
                });
            });
        }

        // ============ DIRECT ACCESS TEST ============
        async function testDirectAccess(url) {
            return new Promise((resolve) => {
                log('Testing direct access...', 'info');
                
                // Try multiple direct access methods
                let testsCompleted = 0;
                let success = false;
                
                // Method 1: Fetch test (lightweight)
                fetch(url, { 
                    method: 'HEAD',
                    mode: 'no-cors',
                    cache: 'no-store'
                }).then(() => {
                    log('  ‚Üí Fetch test passed', 'success');
                    success = true;
                    resolve(true);
                }).catch(() => {
                    testsCompleted++;
                    log('  ‚Üí Fetch test failed', 'error');
                });
                
                // Method 2: Image load test
                const img = new Image();
                img.onload = () => {
                    log('  ‚Üí Image load test passed', 'success');
                    success = true;
                    resolve(true);
                };
                img.onerror = () => {
                    testsCompleted++;
                    log('  ‚Üí Image load test failed', 'error');
                };
                img.src = url + '?test=' + Date.now();
                
                // Method 3: Script test
                const script = document.createElement('script');
                script.onload = () => {
                    log('  ‚Üí Script load test passed', 'success');
                    success = true;
                    resolve(true);
                };
                script.onerror = () => {
                    testsCompleted++;
                    log('  ‚Üí Script load test failed', 'error');
                };
                script.src = url + '?js=' + Date.now();
                document.head.appendChild(script);
                setTimeout(() => script.remove(), 1000);
                
                // Timeout if all tests fail
                setTimeout(() => {
                    if (!success) {
                        log('All direct tests failed', 'error');
                        resolve(false);
                    }
                }, 5000);
            });
        }

        // ============ DISPLAY RESULTS ============
        function displayResult(result) {
            const card = document.createElement('div');
            card.className = `result-card ${result.working ? 'working' : 'failed'}`;
            card.id = `result-${result.method.id}`;
            
            const statusIcon = result.working ? '‚úÖ' : '‚ùå';
            const statusText = result.working ? 'WORKS' : 'FAILED';
            const statusColor = result.working ? '#10b981' : '#ef4444';
            
            card.innerHTML = `
                <div class="result-status">
                    <span style="font-size:1.5rem">${result.method.icon}</span>
                    <span class="result-name">${result.method.name}</span>
                    <span style="color:${statusColor};font-weight:bold">${statusIcon} ${statusText}</span>
                </div>
                <div class="result-desc">${result.method.description}</div>
                ${result.working ? `<button class="use-btn" data-url="${result.url}">USE THIS METHOD</button>` : ''}
            `;
            
            elements.resultsGrid.appendChild(card);
            
            // Add click handler for use button
            if (result.working) {
                setTimeout(() => {
                    const useBtn = card.querySelector('.use-btn');
                    if (useBtn) {
                        useBtn.addEventListener('click', () => {
                            log(`Opening with ${result.method.name}...`, 'info');
                            window.open(result.url, `use_${result.method.id}`);
                        });
                    }
                }, 100);
            }
        }

        function displayDirectResult(result) {
            elements.directResultSection.innerHTML = '';
            
            const div = document.createElement('div');
            div.className = 'direct-result';
            
            if (result.working) {
                div.innerHTML = `
                    <div style="display:flex;align-items:center;gap:15px;margin-bottom:10px;">
                        <span style="font-size:2rem">üéØ</span>
                        <div>
                            <h3 style="color:#10b981;margin:0;">DIRECT ACCESS WORKS!</h3>
                            <p style="color:#94a3b8;margin:5px 0;">Site is not blocked. Use direct connection.</p>
                        </div>
                    </div>
                    <button class="use-btn" style="background:#8b5cf6;" id="directUseBtn">
                        üöÄ OPEN DIRECTLY
                    </button>
                `;
                
                document.getElementById('directUseBtn').addEventListener('click', () => {
                    window.open(result.url, '_direct');
                });
                
                log('‚úÖ DIRECT ACCESS AVAILABLE - Site is not blocked!', 'success');
                
            } else {
                div.innerHTML = `
                    <div style="display:flex;align-items:center;gap:15px;">
                        <span style="font-size:2rem">üö´</span>
                        <div>
                            <h3 style="color:#ef4444;margin:0;">DIRECT ACCESS BLOCKED</h3>
                            <p style="color:#94a3b8;margin:5px 0;">Site is blocked. Testing proxy methods...</p>
                        </div>
                    </div>
                `;
                
                log('‚ùå Direct access blocked. Testing proxy methods...', 'warning');
            }
            
            elements.directResultSection.appendChild(div);
        }

        // ============ MAIN SCAN FUNCTION ============
        async function startSmartScan() {
            if (scanActive) {
                stopScan();
                return;
            }
            
            const input = elements.urlInput.value.trim();
            if (!input || !input.includes('.')) {
                log('Please enter a valid URL', 'error');
                return;
            }
            
            // Format URL
            let url = input;
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                url = 'https://' + url;
            }
            
            // Reset state
            scanActive = true;
            scanResults = {};
            directTestResult = null;
            stats.tested = 0;
            stats.working = 0;
            currentPhase = 1;
            
            // Clear UI
            elements.resultsGrid.innerHTML = '';
            elements.directResultSection.innerHTML = '';
            elements.resultsSection.style.display = 'block';
            
            // Update button
            elements.scanBtn.textContent = '‚èπÔ∏è STOP SCAN';
            elements.scanBtn.className = 'scan-btn stop';
            
            log(`üöÄ Starting SMART SCAN for: ${url}`, 'info');
            log('PHASE 1: Testing direct connection...', 'info');
            
            updateStats();
            updateProgress(1, 0, 1);
            
            // ============ PHASE 1: DIRECT TEST ============
            const directMethods = SMART_METHODS.filter(m => m.phase === 1);
            
            for (let i = 0; i < directMethods.length; i++) {
                if (!scanActive) break;
                
                const method = directMethods[i];
                updateProgress(1, i + 1, directMethods.length);
                
                try {
                    const result = await smartTestMethod(method, url);
                    scanResults[method.id] = result;
                    stats.tested++;
                    
                    if (result.working) {
                        stats.working++;
                        directTestResult = true;
                        displayDirectResult(result);
                        displayResult(result);
                        
                        // If direct works, we can optionally skip proxy tests
                        log('Direct access works! You can stop scan or continue testing proxies.', 'success');
                        
                        // Ask user if they want to continue with proxies
                        setTimeout(() => {
                            if (scanActive && confirm('Direct access works! Continue testing proxy methods?')) {
                                // Continue with proxies
                                log('Continuing with proxy tests...', 'info');
                            } else {
                                stopScan();
                            }
                        }, 1000);
                        
                        break; // Stop direct tests after first success
                    }
                    
                } catch (error) {
                    log(`Error testing ${method.name}: ${error.message}`, 'error');
                }
            }
            
            // If no direct method worked, set directTestResult to false
            if (directTestResult === null) {
                directTestResult = false;
                displayDirectResult({ working: false, method: { name: 'Direct Access' } });
                log('Direct access blocked. Starting proxy tests...', 'warning');
            }
            
            updateStats();
            
            // ============ PHASE 2-4: PROXY TESTS (if direct failed or user wants) ============
            if (scanActive && (!directTestResult || confirm('Test proxy methods anyway?'))) {
                
                // Get proxy methods by phase
                for (let phase = 2; phase <= 4; phase++) {
                    if (!scanActive) break;
                    
                    const phaseMethods = SMART_METHODS.filter(m => m.phase === phase);
                    
                    log(`\nPHASE ${phase}: Testing ${phaseMethods.length} methods...`, 'info');
                    
                    for (let i = 0; i < phaseMethods.length; i++) {
                        if (!scanActive) break;
                        
                        const method = phaseMethods[i];
                        updateProgress(phase, i + 1, phaseMethods.length);
                        
                        try {
                            const result = await smartTestMethod(method, url);
                            scanResults[method.id] = result;
                            stats.tested++;
                            
                            if (result.working) {
                                stats.working++;
                                displayResult(result);
                            }
                            
                        } catch (error) {
                            log(`Error: ${error.message}`, 'error');
                        }
                        
                        updateStats();
                    }
                }
            }
            
            // ============ SCAN COMPLETE ============
            if (scanActive) {
                scanComplete();
            }
        }

        function scanComplete() {
            scanActive = false;
            
            const totalWorked = stats.working;
            const directWorked = directTestResult === true;
            
            if (directWorked) {
                elements.progressText.textContent = `‚úÖ Scan complete: DIRECT ACCESS WORKS!`;
                log('üéâ SCAN COMPLETE: Site is accessible directly!', 'success');
            } else if (totalWorked > 0) {
                elements.progressText.textContent = `‚úÖ Scan complete: ${totalWorked} proxy methods work`;
                log(`üéâ SCAN COMPLETE: ${totalWorked} methods work!`, 'success');
            } else {
                elements.progressText.textContent = `‚ùå Scan complete: No methods work`;
                log('üòû SCAN COMPLETE: No methods work for this site.', 'error');
            }
            
            elements.scanBtn.textContent = 'üöÄ START SMART SCAN';
            elements.scanBtn.className = 'scan-btn';
            
            // Add summary
            setTimeout(() => {
                if (directWorked) {
                    log('üí° TIP: Use DIRECT ACCESS for best performance', 'info');
                } else if (totalWorked > 0) {
                    log('üí° TIP: Click "USE THIS METHOD" on working cards', 'info');
                } else {
                    log('üí° TIP: Try a different URL or check your connection', 'info');
                }
            }, 500);
        }

        function stopScan() {
            scanActive = false;
            elements.scanBtn.textContent = 'üöÄ START SMART SCAN';
            elements.scanBtn.className = 'scan-btn';
            elements.progressText.textContent = 'Scan stopped';
            log('Scan stopped by user', 'warning');
        }

        // ============ INITIALIZATION ============
        function init() {
            // Start scan button
            elements.scanBtn.addEventListener('click', startSmartScan);
            
            // Enter key in input
            elements.urlInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    startSmartScan();
                }
            });
            
            // Escape to stop
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && scanActive) {
                    stopScan();
                }
            });
            
            // Quick test links
            const testUrls = [
                {name: 'YouTube', url: 'youtube.com'},
                {name: 'Reddit', url: 'reddit.com'},
                {name: 'Google', url: 'google.com'},
                {name: 'Twitter', url: 'twitter.com'}
            ];
            
            testUrls.forEach(test => {
                const btn = document.createElement('button');
                btn.className = 'quick-btn';
                btn.style.cssText = 'margin:5px;padding:5px 10px;background:#475569;border:none;border-radius:5px;color:#e2e8f0;cursor:pointer;';
                btn.textContent = test.name;
                btn.addEventListener('click', () => {
                    elements.urlInput.value = test.url;
                    log(`Loaded: ${test.url}`, 'info');
                });
                document.querySelector('.search-box').appendChild(btn);
            });
            
            // Initial stats
            updateStats();
            
            // Welcome
            log('Smart Auto Scan v2.0 loaded', 'info');
            log('Tests DIRECT first, then proxy methods', 'info');
            log('Enter URL and click START SMART SCAN', 'info');
            
            // Auto-focus
            elements.urlInput.focus();
            elements.urlInput.select();
        }

        // Start
        init();
        
    </script>
</body>
</html>
