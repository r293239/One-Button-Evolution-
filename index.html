<!DOCTYPE html>
<html>
<head>
    <title>Complete Enhanced Portal v2.0</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #e2e8f0;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(30, 41, 59, 0.8);
            border-radius: 15px;
            border: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        h1 {
            font-size: 2.5rem;
            color: #60a5fa;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #94a3b8;
        }
        
        .search-section {
            background: rgba(30, 41, 59, 0.8);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        #urlInput {
            flex: 1;
            padding: 15px;
            font-size: 16px;
            border: 2px solid #475569;
            border-radius: 10px;
            background: #1e293b;
            color: #e2e8f0;
        }
        
        #urlInput:focus {
            outline: none;
            border-color: #60a5fa;
        }
        
        .main-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .main-btn {
            padding: 15px 25px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            flex: 1;
            min-width: 200px;
            font-weight: bold;
        }
        
        .main-btn.auto {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        
        .main-btn.direct {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
        }
        
        .main-btn.stop {
            background: linear-gradient(135deg, #ef4444, #b91c1c);
        }
        
        .main-btn.discovery {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        
        .main-btn.enhanced {
            background: linear-gradient(135deg, #ec4899, #db2777);
        }
        
        .main-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .main-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .quick-links {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .quick-btn {
            padding: 8px 15px;
            background: #475569;
            color: #e2e8f0;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .quick-btn:hover {
            background: #60a5fa;
            color: white;
        }
        
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
        }
        
        @media (max-width: 900px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
        }
        
        .manual-methods {
            background: rgba(30, 41, 59, 0.8);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(148, 163, 184, 0.2);
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .methods-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .method-card {
            background: rgba(15, 23, 42, 0.8);
            border: 2px solid #475569;
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .method-card:hover {
            border-color: #60a5fa;
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(96, 165, 250, 0.2);
        }
        
        .method-card:active {
            transform: translateY(-2px);
        }
        
        .method-card.game {
            border-color: #f59e0b;
            background: rgba(245, 158, 11, 0.1);
        }
        
        .method-card.enhanced {
            border-color: #ec4899;
            background: rgba(236, 72, 153, 0.1);
        }
        
        .method-card.discovery {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }
        
        .method-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .method-name {
            font-weight: bold;
            margin-bottom: 5px;
            color: #e2e8f0;
        }
        
        .method-desc {
            font-size: 0.85rem;
            color: #94a3b8;
            line-height: 1.4;
        }
        
        .scan-results {
            background: rgba(30, 41, 59, 0.8);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .section-title {
            color: #60a5fa;
            font-size: 1.3rem;
            font-weight: bold;
        }
        
        .stats {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .stat {
            background: rgba(15, 23, 42, 0.8);
            padding: 15px;
            border-radius: 10px;
            flex: 1;
            min-width: 120px;
            text-align: center;
            border: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #60a5fa;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #94a3b8;
        }
        
        .progress-container {
            margin: 20px 0;
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #475569;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #3b82f6);
            width: 0%;
            transition: width 0.3s;
        }
        
        .result-cards {
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .result-card {
            background: rgba(15, 23, 42, 0.8);
            border: 2px solid #475569;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .result-card:hover {
            border-color: #60a5fa;
        }
        
        .result-card.working {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }
        
        .result-card.failed {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }
        
        .result-card.testing {
            border-color: #f59e0b;
            background: rgba(245, 158, 11, 0.1);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .result-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .use-btn {
            padding: 8px 15px;
            background: #10b981;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .use-btn:hover {
            background: #0da271;
        }
        
        .log-box {
            background: rgba(15, 23, 42, 0.8);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
            border: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        .log-entry {
            margin-bottom: 5px;
            padding: 5px 0;
            border-bottom: 1px solid rgba(148, 163, 184, 0.1);
        }
        
        .success { color: #10b981; }
        .error { color: #ef4444; }
        .info { color: #60a5fa; }
        .warning { color: #f59e0b; }
        
        .category-title {
            color: #94a3b8;
            font-size: 1.1rem;
            margin: 25px 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        .category-title:first-child {
            margin-top: 0;
        }
        
        .direct-result {
            background: rgba(139, 92, 246, 0.2);
            border: 2px solid #8b5cf6;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .discovery-panel {
            background: rgba(16, 185, 129, 0.1);
            border: 2px solid #10b981;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        /* EMBED VIEWER STYLES */
        .embed-viewer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.95);
            z-index: 1000;
            display: none;
            flex-direction: column;
            backdrop-filter: blur(10px);
        }
        
        .viewer-header {
            background: rgba(30, 41, 59, 0.9);
            padding: 15px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        .viewer-title {
            font-size: 1.2rem;
            color: #60a5fa;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .viewer-controls {
            display: flex;
            gap: 10px;
        }
        
        .control-btn {
            padding: 8px 16px;
            background: #475569;
            color: #e2e8f0;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .control-btn:hover {
            background: #60a5fa;
            color: white;
        }
        
        .control-btn.close {
            background: #ef4444;
            color: white;
        }
        
        .control-btn.close:hover {
            background: #dc2626;
        }
        
        .viewer-content {
            flex: 1;
            position: relative;
            overflow: hidden;
        }
        
        .viewer-frame {
            width: 100%;
            height: 100%;
            border: none;
            background: white;
        }
        
        .viewer-loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: #60a5fa;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(96, 165, 250, 0.3);
            border-radius: 50%;
            border-top-color: #60a5fa;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .viewer-method-info {
            background: rgba(15, 23, 42, 0.8);
            padding: 10px 15px;
            border-top: 1px solid rgba(148, 163, 184, 0.2);
            font-size: 0.9rem;
            color: #94a3b8;
        }
        
        .iframe-container {
            position: relative;
            width: 100%;
            height: 100%;
        }
        
        .method-tag {
            display: inline-block;
            padding: 2px 8px;
            background: #475569;
            color: #e2e8f0;
            border-radius: 10px;
            font-size: 0.7rem;
            margin-left: 5px;
        }
        
        .tag-game { background: #f59e0b; }
        .tag-enhanced { background: #ec4899; }
        .tag-discovery { background: #10b981; }
        
        .tab-container {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            border-bottom: 2px solid #475569;
            padding-bottom: 10px;
        }
        
        .tab {
            padding: 10px 20px;
            background: #475569;
            color: #e2e8f0;
            border: none;
            border-radius: 10px 10px 0 0;
            cursor: pointer;
        }
        
        .tab.active {
            background: #3b82f6;
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .proxy-sources {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        .source-btn {
            padding: 8px 15px;
            background: #374151;
            color: #e2e8f0;
            border: 1px solid #4b5563;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .source-btn.active {
            background: #10b981;
            color: white;
            border-color: #10b981;
        }
        
        .feedback-form {
            background: rgba(15, 23, 42, 0.8);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .feedback-input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            background: #1e293b;
            border: 1px solid #475569;
            border-radius: 5px;
            color: #e2e8f0;
        }
        
        .rating {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }
        
        .rating-btn {
            padding: 5px 10px;
            background: #475569;
            color: #e2e8f0;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .rating-btn.active {
            background: #f59e0b;
            color: white;
        }
    </style>
</head>
<body>
    <!-- Embed Viewer (hidden by default) -->
    <div class="embed-viewer" id="embedViewer">
        <div class="viewer-header">
            <div class="viewer-title">
                <span id="viewerMethodIcon">üåê</span>
                <span id="viewerMethodName">Loading...</span>
                <span style="color:#94a3b8;font-size:0.9rem;" id="viewerUrl"></span>
            </div>
            <div class="viewer-controls">
                <button class="control-btn" id="viewerBackBtn">‚Üê Back</button>
                <button class="control-btn" id="viewerReloadBtn">‚Üª Reload</button>
                <button class="control-btn" id="viewerNewTabBtn">‚Üó New Tab</button>
                <button class="control-btn close" id="viewerCloseBtn">‚úï Close</button>
            </div>
        </div>
        <div class="viewer-content" id="viewerContent">
            <div class="viewer-loading" id="viewerLoading">
                <div class="spinner"></div>
                <p>Loading embedded viewer...</p>
            </div>
            <div class="iframe-container">
                <iframe class="viewer-frame" id="viewerFrame" sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox"></iframe>
            </div>
        </div>
        <div class="viewer-method-info" id="viewerMethodInfo">
            Using proxy method. Site is loaded discreetly in this frame.
        </div>
    </div>
    
    <div class="container">
        <header>
            <h1>üîì Complete Enhanced Portal v2.0</h1>
            <p class="subtitle">Wayback Focus ‚Ä¢ Proxy Discovery ‚Ä¢ Smart Selection ‚Ä¢ All Upgrades</p>
        </header>
        
        <div class="search-section">
            <div class="search-box">
                <input type="text" id="urlInput" placeholder="Enter website URL (e.g., youtube.com)" value="youtube.com">
                <button class="main-btn auto" id="autoBtn">ü§ñ AUTO SCAN</button>
                <button class="main-btn enhanced" id="enhancedBtn">üöÄ ENHANCED SCAN</button>
            </div>
            
            <div class="main-buttons">
                <button class="main-btn direct" id="directBtn">üéØ DIRECT TEST</button>
                <button class="main-btn discovery" id="discoveryBtn">üîç FIND PROXIES</button>
                <button class="main-btn" id="openAllBtn">‚ö° TEST ALL METHODS</button>
            </div>
            
            <div class="quick-links">
                <button class="quick-btn" data-url="youtube.com">YouTube</button>
                <button class="quick-btn" data-url="reddit.com">Reddit</button>
                <button class="quick-btn" data-url="twitter.com">Twitter</button>
                <button class="quick-btn" data-url="coolmathgames.com">CoolMath</button>
                <button class="quick-btn" data-url="poki.com">Poki</button>
                <button class="quick-btn" data-url="crazygames.com">CrazyGames</button>
                <button class="quick-btn" data-url="netflix.com">Netflix</button>
                <button class="quick-btn" data-url="instagram.com">Instagram</button>
            </div>
        </div>
        
        <div class="tab-container">
            <button class="tab active" data-tab="methods">üß© All Methods</button>
            <button class="tab" data-tab="discovery">üîç Proxy Discovery</button>
            <button class="tab" data-tab="history">üìä History & Stats</button>
            <button class="tab" data-tab="feedback">üí¨ Feedback</button>
        </div>
        
        <div class="content-wrapper">
            <!-- LEFT SIDE: ALL METHODS -->
            <div class="manual-methods">
                <h2 class="section-title">‚ö° All Bypass Methods</h2>
                <p style="color:#94a3b8;margin-bottom:20px;">Click any method to open in embedded viewer</p>
                
                <!-- ENHANCED: Wayback Focus -->
                <div class="category-title">üìö Wayback Focus <span class="method-tag tag-enhanced">ENHANCED</span></div>
                <div class="methods-grid">
                    <div class="method-card enhanced" data-method="enhancedWayback">
                        <div class="method-icon">üöÄ</div>
                        <div class="method-name">Enhanced Wayback</div>
                        <div class="method-desc">Multi-archive fallback system</div>
                    </div>
                    
                    <div class="method-card enhanced" data-method="smartArchive">
                        <div class="method-icon">üß†</div>
                        <div class="method-name">Smart Archive</div>
                        <div class="method-desc">Intelligent date selection</div>
                    </div>
                    
                    <div class="method-card enhanced" data-method="archiveSearch">
                        <div class="method-icon">üîé</div>
                        <div class="method-name">Archive Search</div>
                        <div class="method-desc">Find best cached version</div>
                    </div>
                </div>
                
                <!-- NEW: Discovery Methods -->
                <div class="category-title">üîç Proxy Discovery <span class="method-tag tag-discovery">NEW</span></div>
                <div class="methods-grid">
                    <div class="method-card discovery" data-method="proxyFinder">
                        <div class="method-icon">üåê</div>
                        <div class="method-name">Proxy Finder</div>
                        <div class="method-desc">Discover new proxies</div>
                    </div>
                    
                    <div class="method-card discovery" data-method="healthCheck">
                        <div class="method-icon">üíö</div>
                        <div class="method-name">Health Check</div>
                        <div class="method-desc">Validate proxy health</div>
                    </div>
                    
                    <div class="method-card discovery" data-method="rotatingProxy">
                        <div class="method-icon">üîÑ</div>
                        <div class="method-name">Rotating Proxy</div>
                        <div class="method-desc">Auto-rotate proxies</div>
                    </div>
                </div>
                
                <!-- Game Methods Section -->
                <div class="category-title">üéÆ Game Access</div>
                <div class="methods-grid">
                    <div class="method-card game" data-method="gameiframe">
                        <div class="method-icon">üéÆ</div>
                        <div class="method-name">Game Iframe</div>
                        <div class="method-desc">Enhanced iframe for games</div>
                    </div>
                    
                    <div class="method-card game" data-method="html5proxy">
                        <div class="method-icon">‚ö°</div>
                        <div class="method-name">HTML5 Proxy</div>
                        <div class="method-desc">HTML5/WebGL games</div>
                    </div>
                    
                    <div class="method-card game" data-method="flashproxy">
                        <div class="method-icon">üíæ</div>
                        <div class="method-name">Flash Proxy</div>
                        <div class="method-desc">Flash/Ruffle games</div>
                    </div>
                    
                    <div class="method-card game" data-method="unityproxy">
                        <div class="method-icon">üéØ</div>
                        <div class="method-name">Unity Proxy</div>
                        <div class="method-desc">Unity/WebGL games</div>
                    </div>
                </div>
                
                <!-- Reliable Proxies -->
                <div class="category-title">üåê Reliable Proxies</div>
                <div class="methods-grid">
                    <div class="method-card" data-method="translate">
                        <div class="method-icon">üåê</div>
                        <div class="method-name">Google Translate</div>
                        <div class="method-desc">Google's built-in proxy</div>
                    </div>
                    
                    <div class="method-card" data-method="archive">
                        <div class="method-icon">üìö</div>
                        <div class="method-name">Wayback Machine</div>
                        <div class="method-desc">Cached website versions</div>
                    </div>
                    
                    <div class="method-card" data-method="mobile">
                        <div class="method-icon">üì±</div>
                        <div class="method-name">Mobile View</div>
                        <div class="method-desc">Mobile version of site</div>
                    </div>
                    
                    <div class="method-card" data-method="cors">
                        <div class="method-icon">‚ö°</div>
                        <div class="method-name">CORS Proxy</div>
                        <div class="method-desc">CORS bypass proxy</div>
                    </div>
                </div>
                
                <!-- Advanced Methods -->
                <div class="category-title">‚ö° Advanced Methods</div>
                <div class="methods-grid">
                    <div class="method-card" data-method="amp">
                        <div class="method-icon">‚ö°</div>
                        <div class="method-name">AMP Cache</div>
                        <div class="method-desc">Google AMP version</div>
                    </div>
                    
                    <div class="method-card" data-method="outline">
                        <div class="method-icon">üìñ</div>
                        <div class="method-name">Outline.com</div>
                        <div class="method-desc">Reader view service</div>
                    </div>
                    
                    <div class="method-card" data-method="iframe">
                        <div class="method-icon">üì∫</div>
                        <div class="method-name">Direct Iframe</div>
                        <div class="method-desc">Simple iframe view</div>
                    </div>
                    
                    <div class="method-card" data-method="mirror">
                        <div class="method-icon">ü™û</div>
                        <div class="method-name">Site Mirror</div>
                        <div class="method-desc">Create local copy</div>
                    </div>
                </div>
            </div>
            
            <!-- RIGHT SIDE: AUTO SCAN RESULTS -->
            <div class="scan-results">
                <div class="tab-content active" id="methods">
                    <div class="results-header">
                        <h2 class="section-title">üìä Scan Results & Live Preview</h2>
                        <button class="main-btn stop" id="stopBtn" style="display:none;">‚èπÔ∏è STOP</button>
                    </div>
                    
                    <div class="direct-result" id="directResult" style="display:none;"></div>
                    
                    <div class="discovery-panel" id="discoveryPanel" style="display:none;">
                        <h3 style="color:#10b981;margin-bottom:10px;">üîç Proxy Discovery Active</h3>
                        <div id="discoveryStatus">Searching for new proxies...</div>
                        <div class="proxy-sources" id="proxySources"></div>
                    </div>
                    
                    <div class="stats">
                        <div class="stat">
                            <div class="stat-value" id="totalMethods">28</div>
                            <div class="stat-label">Total Methods</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="testedMethods">0</div>
                            <div class="stat-label">Tested</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="workingMethods">0</div>
                            <div class="stat-label">Working</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="successRate">0%</div>
                            <div class="stat-label">Success Rate</div>
                        </div>
                    </div>
                    
                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <div id="progressText" style="text-align:center;margin-top:5px;color:#94a3b8;">
                            Ready to scan...
                        </div>
                    </div>
                    
                    <div class="result-cards" id="resultCards"></div>
                    
                    <div class="log-box" id="logBox">
                        <div class="log-entry info">Enhanced Portal v2.0 loaded with 28 methods.</div>
                        <div class="log-entry info">Wayback focus enabled with proxy discovery.</div>
                    </div>
                </div>
                
                <div class="tab-content" id="discovery">
                    <h2 class="section-title">üîç Proxy Discovery Engine</h2>
                    <div class="discovery-panel">
                        <h3 style="color:#10b981;">Proxy Sources</h3>
                        <div class="proxy-sources">
                            <button class="source-btn active" data-source="wayback">Wayback Machine</button>
                            <button class="source-btn" data-source="google">Google Search</button>
                            <button class="source-btn" data-source="github">GitHub Public APIs</button>
                            <button class="source-btn" data-source="freeproxylists">Free Proxy Lists</button>
                            <button class="source-btn" data-source="news">News Sites</button>
                        </div>
                        
                        <button class="use-btn" style="margin:15px 0;" id="startDiscovery">üöÄ Start Discovery</button>
                        
                        <div id="discoveryResults" style="margin-top:20px;">
                            <h4 style="color:#94a3b8;">Discovered Proxies:</h4>
                            <div id="proxyList" style="margin-top:10px;"></div>
                        </div>
                    </div>
                </div>
                
                <div class="tab-content" id="history">
                    <h2 class="section-title">üìä History & Statistics</h2>
                    <div class="stats">
                        <div class="stat">
                            <div class="stat-value" id="totalScans">0</div>
                            <div class="stat-label">Total Scans</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="workingCache">0</div>
                            <div class="stat-label">Cached Methods</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="avgSuccess">0%</div>
                            <div class="stat-label">Avg. Success</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="topMethod">-</div>
                            <div class="stat-label">Best Method</div>
                        </div>
                    </div>
                    
                    <div style="margin:20px 0;">
                        <h4 style="color:#94a3b8;">Most Successful Methods:</h4>
                        <div id="methodRanking" style="margin-top:10px;"></div>
                    </div>
                </div>
                
                <div class="tab-content" id="feedback">
                    <h2 class="section-title">üí¨ User Feedback System</h2>
                    <div class="feedback-form">
                        <h4 style="color:#60a5fa;">Rate Current Method:</h4>
                        <div class="rating">
                            <button class="rating-btn" data-rating="1">‚≠ê</button>
                            <button class="rating-btn" data-rating="2">‚≠ê‚≠ê</button>
                            <button class="rating-btn" data-rating="3">‚≠ê‚≠ê‚≠ê</button>
                            <button class="rating-btn" data-rating="4">‚≠ê‚≠ê‚≠ê‚≠ê</button>
                            <button class="rating-btn" data-rating="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</button>
                        </div>
                        
                        <input type="text" class="feedback-input" id="feedbackUrl" placeholder="Website URL">
                        <textarea class="feedback-input" id="feedbackText" placeholder="Your feedback..."></textarea>
                        
                        <button class="use-btn" id="submitFeedback">Submit Feedback</button>
                    </div>
                    
                    <div style="margin-top:20px;">
                        <h4 style="color:#94a3b8;">Community Insights:</h4>
                        <div id="communityTips" style="margin-top:10px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============ ENHANCED METHOD LIBRARY ============
        const ALL_METHODS = {
            // ENHANCED WAYBACK METHODS
            enhancedWayback: {
                name: 'Enhanced Wayback',
                icon: 'üöÄ',
                category: 'enhanced',
                execute: (url) => {
                    const clean = url.replace(/^https?:\/\//, '');
                    const now = new Date();
                    const dates = [
                        now.toISOString().split('T')[0],
                        new Date(now.setDate(now.getDate() - 1)).toISOString().split('T')[0],
                        new Date(now.setDate(now.getDate() - 7)).toISOString().split('T')[0],
                        '2023', '2022', '2021'
                    ];
                    
                    const urls = [];
                    dates.forEach(date => {
                        urls.push(`https://web.archive.org/web/${date}/${url}`);
                    });
                    
                    // Additional archives
                    urls.push(`https://archive.is/${clean}`);
                    urls.push(`https://archive.today/${clean}`);
                    urls.push(`https://arquivo.pt/wayback/${dates[0]}/${url}`);
                    urls.push(`https://perma.cc/${clean}`);
                    
                    return urls;
                },
                enhanced: true,
                successRate: localStorage.getItem('method_success_enhancedWayback') || 85
            },
            
            smartArchive: {
                name: 'Smart Archive',
                icon: 'üß†',
                category: 'enhanced',
                execute: (url) => {
                    const clean = url.replace(/^https?:\/\//, '');
                    // Try different archive formats
                    return [
                        `https://web.archive.org/web/*/${url}`,
                        `https://archive.org/wayback/available?url=${encodeURIComponent(url)}`,
                        `https://archive.today/?run=1&url=${encodeURIComponent(url)}`
                    ];
                },
                enhanced: true,
                successRate: localStorage.getItem('method_success_smartArchive') || 78
            },
            
            archiveSearch: {
                name: 'Archive Search',
                icon: 'üîé',
                category: 'enhanced',
                execute: (url) => {
                    const clean = url.replace(/^https?:\/\//, '');
                    // Search for best cached version
                    return [
                        `https://web.archive.org/web/2/${url}`,
                        `https://web.archive.org/web/0/${url}`,
                        `https://cachedview.com/${clean}`,
                        `https://cachedpages.com/?q=${encodeURIComponent(url)}`
                    ];
                },
                enhanced: true,
                successRate: localStorage.getItem('method_success_archiveSearch') || 82
            },
            
            // DISCOVERY METHODS
            proxyFinder: {
                name: 'Proxy Finder',
                icon: 'üåê',
                category: 'discovery',
                execute: (url) => {
                    // This would integrate with proxy discovery engine
                    const discoveredProxies = JSON.parse(localStorage.getItem('discovered_proxies') || '[]');
                    const encoded = encodeURIComponent(url);
                    
                    let urls = [];
                    if (discoveredProxies.length > 0) {
                        discoveredProxies.forEach(proxy => {
                            if (proxy.url && proxy.health > 50) {
                                urls.push(proxy.url.replace('{url}', encoded));
                            }
                        });
                    }
                    
                    // Fallback to known proxies
                    if (urls.length === 0) {
                        urls = [
                            `https://corsproxy.io/?${encoded}`,
                            `https://api.allorigins.win/get?url=${encoded}`
                        ];
                    }
                    
                    return urls;
                },
                discovery: true,
                successRate: localStorage.getItem('method_success_proxyFinder') || 65
            },
            
            healthCheck: {
                name: 'Health Check',
                icon: 'üíö',
                category: 'discovery',
                execute: (url) => {
                    // Health check proxy
                    const checkHTML = `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Proxy Health Check</title>
    <style>
        body { background: #0f172a; color: #e2e8f0; padding: 20px; font-family: sans-serif; }
        .status { padding: 20px; border-radius: 10px; margin: 10px 0; }
        .healthy { background: #10b98120; border: 2px solid #10b981; }
        .unhealthy { background: #ef444420; border: 2px solid #ef4444; }
        .testing { background: #f59e0b20; border: 2px solid #f59e0b; }
    </style>
</head>
<body>
    <h2>üîç Proxy Health Check</h2>
    <div class="status testing" id="status">Testing proxy health for: ${url}</div>
    <script>
        async function testProxy() {
            const url = "${url}";
            const statusEl = document.getElementById('status');
            
            try {
                const response = await fetch('https://corsproxy.io/?' + encodeURIComponent(url));
                if (response.ok) {
                    statusEl.className = 'status healthy';
                    statusEl.innerHTML = '‚úÖ <strong>Proxy Healthy</strong><br>Successfully connected to: ' + url;
                } else {
                    throw new Error('Proxy failed');
                }
            } catch (error) {
                statusEl.className = 'status unhealthy';
                statusEl.innerHTML = '‚ùå <strong>Proxy Unhealthy</strong><br>Failed to connect to: ' + url;
            }
        }
        
        setTimeout(testProxy, 1000);
    <\/script>
</body>
</html>`;
                    
                    return ['data:text/html;charset=utf-8,' + encodeURIComponent(checkHTML)];
                },
                discovery: true,
                successRate: localStorage.getItem('method_success_healthCheck') || 70
            },
            
            rotatingProxy: {
                name: 'Rotating Proxy',
                icon: 'üîÑ',
                category: 'discovery',
                execute: (url) => {
                    const proxies = [
                        'https://corsproxy.io/?',
                        'https://api.allorigins.win/get?url=',
                        'https://thingproxy.freeboard.io/fetch/',
                        'https://api.codetabs.com/v1/proxy?quest='
                    ];
                    
                    const randomProxy = proxies[Math.floor(Math.random() * proxies.length)];
                    const encoded = encodeURIComponent(url);
                    
                    return [randomProxy + encoded];
                },
                discovery: true,
                successRate: localStorage.getItem('method_success_rotatingProxy') || 75
            },
            
            // GAME METHODS
            gameiframe: {
                name: 'Game Iframe',
                icon: 'üéÆ',
                category: 'game',
                execute: (url) => {
                    const gameHTML = `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Portal</title>
    <style>
        body { margin: 0; padding: 10px; background: #0f172a; }
        .game-container { 
            border-radius: 10px; 
            overflow: hidden; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        iframe { 
            width: 100%; 
            height: calc(100vh - 20px); 
            border: none; 
        }
    </style>
</head>
<body>
    <div class="game-container">
        <iframe src="${url}" 
                sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox allow-modals"
                allow="autoplay; fullscreen"
                title="Game Preview">
        </iframe>
    </div>
</body>
</html>`;
                    return ['data:text/html;charset=utf-8,' + encodeURIComponent(gameHTML)];
                },
                game: true,
                successRate: localStorage.getItem('method_success_gameiframe') || 80
            },
            
            html5proxy: {
                name: 'HTML5 Proxy',
                icon: '‚ö°',
                category: 'game',
                execute: (url) => {
                    const encoded = encodeURIComponent(url);
                    return [
                        `https://html5.gamesproxy.workers.dev/?url=${encoded}`,
                        `https://game-proxy.pages.dev/?url=${encoded}`,
                        `https://corsproxy.io/?${encoded}`
                    ];
                },
                game: true,
                successRate: localStorage.getItem('method_success_html5proxy') || 75
            },
            
            // ALL ORIGINAL METHODS (preserved)
            translate: {
                name: 'Google Translate',
                icon: 'üåê',
                category: 'reliable',
                execute: (url) => {
                    const encoded = encodeURIComponent(url);
                    return [
                        `https://translate.google.com/translate?hl=en&sl=auto&tl=en&u=${encoded}`,
                        `https://translate.googleusercontent.com/translate?hl=en&sl=auto&tl=en&u=${encoded}`
                    ];
                },
                successRate: localStorage.getItem('method_success_translate') || 85
            },
            
            archive: {
                name: 'Wayback Machine',
                icon: 'üìö',
                category: 'reliable',
                execute: (url) => {
                    const clean = url.replace(/^https?:\/\//, '');
                    return [
                        `https://web.archive.org/web/${url}`,
                        `https://archive.is/${clean}`,
                        `https://archive.today/${clean}`
                    ];
                },
                successRate: localStorage.getItem('method_success_archive') || 90
            },
            
            mobile: {
                name: 'Mobile View',
                icon: 'üì±',
                category: 'reliable',
                execute: (url) => {
                    const clean = url.replace(/^https?:\/\//, '');
                    return [
                        `https://m.${clean}`,
                        `https://mobile.${clean}`,
                        `https://www.google.com/amp/s/${clean}`
                    ];
                },
                successRate: localStorage.getItem('method_success_mobile') || 70
            },
            
            cors: {
                name: 'CORS Proxy',
                icon: '‚ö°',
                category: 'reliable',
                execute: (url) => {
                    const encoded = encodeURIComponent(url);
                    return [
                        `https://corsproxy.io/?${encoded}`,
                        `https://api.codetabs.com/v1/proxy?quest=${url}`,
                        `https://thingproxy.freeboard.io/fetch/${url}`
                    ];
                },
                successRate: localStorage.getItem('method_success_cors') || 82
            },
            
            allorigins: {
                name: 'All Origins',
                icon: 'üåç',
                category: 'reliable',
                execute: (url) => {
                    const encoded = encodeURIComponent(url);
                    return [
                        `https://api.allorigins.win/get?url=${encoded}`,
                        `https://api.allorigins.win/raw?url=${encoded}`
                    ];
                },
                successRate: localStorage.getItem('method_success_allorigins') || 78
            },
            
            amp: {
                name: 'AMP Cache',
                icon: '‚ö°',
                category: 'advanced',
                execute: (url) => {
                    const clean = url.replace(/^https?:\/\//, '');
                    return [
                        `https://www.google.com/amp/s/${clean}`,
                        `https://cdn.ampproject.org/c/${url}`
                    ];
                },
                successRate: localStorage.getItem('method_success_amp') || 75
            },
            
            iframe: {
                name: 'Direct Iframe',
                icon: 'üì∫',
                category: 'advanced',
                execute: (url) => {
                    const iframeHTML = `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Iframe Viewer</title>
    <style>
        body { margin: 0; padding: 10px; background: #0f172a; }
        .iframe-container { 
            border-radius: 10px; 
            overflow: hidden; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        iframe { 
            width: 100%; 
            height: calc(100vh - 20px); 
            border: none; 
        }
    </style>
</head>
<body>
    <div class="iframe-container">
        <iframe src="${url}" title="Website Preview"></iframe>
    </div>
</body>
</html>`;
                    return ['data:text/html;charset=utf-8,' + encodeURIComponent(iframeHTML)];
                },
                successRate: localStorage.getItem('method_success_iframe') || 60
            }
        };

        // ============ ENHANCED STATE ============
        let scanActive = false;
        let scanResults = {};
        let directTestResult = null;
        let discoveryActive = false;
        let stats = {
            total: Object.keys(ALL_METHODS).length,
            tested: 0,
            working: 0,
            successRate: 0
        };
        
        // Discovery data
        const DISCOVERY_SOURCES = {
            wayback: {
                name: 'Wayback Machine',
                url: 'https://web.archive.org/',
                type: 'archive'
            },
            google: {
                name: 'Google Search',
                url: 'https://www.google.com/search?q=free+web+proxy+2024',
                type: 'search'
            },
            github: {
                name: 'GitHub Public APIs',
                url: 'https://api.github.com/search/repositories?q=web+proxy',
                type: 'api'
            },
            freeproxylists: {
                name: 'Free Proxy Lists',
                url: 'https://free-proxy-list.net/',
                type: 'proxy_list'
            },
            news: {
                name: 'News Sites',
                url: 'https://www.straitstimes.com/',
                type: 'news'
            }
        };

        // ============ DOM ELEMENTS ============
        const elements = {
            urlInput: document.getElementById('urlInput'),
            autoBtn: document.getElementById('autoBtn'),
            enhancedBtn: document.getElementById('enhancedBtn'),
            directBtn: document.getElementById('directBtn'),
            discoveryBtn: document.getElementById('discoveryBtn'),
            openAllBtn: document.getElementById('openAllBtn'),
            stopBtn: document.getElementById('stopBtn'),
            directResult: document.getElementById('directResult'),
            discoveryPanel: document.getElementById('discoveryPanel'),
            resultCards: document.getElementById('resultCards'),
            logBox: document.getElementById('logBox'),
            progressFill: document.getElementById('progressFill'),
            progressText: document.getElementById('progressText'),
            embedViewer: document.getElementById('embedViewer'),
            viewerFrame: document.getElementById('viewerFrame'),
            viewerLoading: document.getElementById('viewerLoading'),
            viewerMethodIcon: document.getElementById('viewerMethodIcon'),
            viewerMethodName: document.getElementById('viewerMethodName'),
            viewerUrl: document.getElementById('viewerUrl'),
            viewerMethodInfo: document.getElementById('viewerMethodInfo'),
            viewerCloseBtn: document.getElementById('viewerCloseBtn'),
            viewerBackBtn: document.getElementById('viewerBackBtn'),
            viewerReloadBtn: document.getElementById('viewerReloadBtn'),
            viewerNewTabBtn: document.getElementById('viewerNewTabBtn'),
            viewerContent: document.getElementById('viewerContent')
        };

        // ============ ENHANCED UTILITIES ============
        function log(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            elements.logBox.prepend(entry);
            if (elements.logBox.children.length > 30) {
                elements.logBox.removeChild(elements.logBox.lastChild);
            }
        }

        function updateProgress(current, total) {
            const progress = (current / total) * 100;
            elements.progressFill.style.width = progress + '%';
            return progress;
        }

        function updateStats() {
            document.getElementById('totalMethods').textContent = stats.total;
            document.getElementById('testedMethods').textContent = stats.tested;
            document.getElementById('workingMethods').textContent = stats.working;
            
            stats.successRate = stats.tested > 0 ? Math.round((stats.working / stats.tested) * 100) : 0;
            document.getElementById('successRate').textContent = stats.successRate + '%';
            
            const directEl = document.getElementById('directStatus');
            if (directTestResult === true) {
                directEl.textContent = '‚úÖ';
                directEl.style.color = '#10b981';
            } else if (directTestResult === false) {
                directEl.textContent = '‚ùå';
                directEl.style.color = '#ef4444';
            } else {
                directEl.textContent = '‚ùì';
                directEl.style.color = '#94a3b8';
            }
        }

        function formatUrl(input) {
            let url = input.trim();
            if (!url.includes('.')) return null;
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                url = 'https://' + url;
            }
            try {
                new URL(url);
                return url;
            } catch {
                return null;
            }
        }

        // ============ SMART METHOD SELECTION ============
        function getBestMethod(url) {
            // Get methods sorted by success rate
            const methods = Object.entries(ALL_METHODS)
                .map(([id, method]) => ({
                    id,
                    ...method,
                    successRate: parseFloat(method.successRate) || 0
                }))
                .sort((a, b) => b.successRate - a.successRate);
            
            // Try to match site type
            const siteType = detectSiteType(url);
            const siteTypeMethods = {
                'youtube': ['enhancedWayback', 'translate', 'mobile'],
                'game': ['gameiframe', 'html5proxy', 'rotatingProxy'],
                'social': ['translate', 'cors', 'amp'],
                'news': ['enhancedWayback', 'archive', 'mobile']
            };
            
            if (siteTypeMethods[siteType]) {
                const preferred = siteTypeMethods[siteType].find(id => ALL_METHODS[id]);
                if (preferred) {
                    log(`Using ${ALL_METHODS[preferred].name} for ${siteType} site`, 'info');
                    return ALL_METHODS[preferred];
                }
            }
            
            // Return best overall method
            return methods[0];
        }

        function detectSiteType(url) {
            if (url.includes('youtube.com') || url.includes('youtu.be')) return 'youtube';
            if (url.includes('game') || url.includes('play') || url.includes('poki')) return 'game';
            if (url.includes('twitter') || url.includes('facebook') || url.includes('instagram')) return 'social';
            if (url.includes('news') || url.includes('times') || url.includes('cnn')) return 'news';
            return 'general';
        }

        // ============ ENHANCED SCAN ============
        async function startEnhancedScan() {
            const input = elements.urlInput.value.trim();
            if (!input) {
                log('Please enter a URL', 'error');
                return;
            }
            
            const url = formatUrl(input);
            if (!url) {
                log('Invalid URL', 'error');
                return;
            }
            
            // Reset state
            scanActive = true;
            scanResults = {};
            stats.tested = 0;
            stats.working = 0;
            elements.resultCards.innerHTML = '';
            elements.stopBtn.style.display = 'block';
            
            // Update UI
            elements.enhancedBtn.disabled = true;
            elements.enhancedBtn.textContent = '‚è≥ ENHANCED SCAN...';
            elements.enhancedBtn.className = 'main-btn stop';
            
            log(`üöÄ Starting ENHANCED SCAN for: ${url}`, 'info');
            log(`Site type detected: ${detectSiteType(url)}`, 'info');
            
            // Get best methods first (smart selection)
            const methodsBySuccess = Object.entries(ALL_METHODS)
                .map(([id, method]) => ({ id, ...method }))
                .sort((a, b) => (b.successRate || 0) - (a.successRate || 0));
            
            const totalMethods = Math.min(methodsBySuccess.length, 10); // Test top 10
            
            for (let i = 0; i < totalMethods; i++) {
                if (!scanActive) break;
                
                const method = methodsBySuccess[i];
                
                // Update progress
                const progress = updateProgress(i + 1, totalMethods);
                elements.progressText.textContent = `${Math.round(progress)}% - Testing ${method.name} (${method.successRate}% success)...`;
                
                // Create testing card
                addResultCard(method, 'testing', null);
                
                // Test the method
                try {
                    const proxyUrls = method.execute(url);
                    const testUrl = proxyUrls && proxyUrls[0];
                    
                    if (testUrl) {
                        const result = await testMethod(testUrl);
                        
                        scanResults[method.id] = {
                            method: method,
                            working: result,
                            url: testUrl,
                            successRate: method.successRate
                        };
                        
                        stats.tested++;
                        
                        if (result) {
                            stats.working++;
                            updateResultCard(method.id, 'working', testUrl);
                            log(`‚úÖ ${method.name} works (${method.successRate}% success rate)`, 'success');
                            
                            // Update success rate
                            const newRate = Math.min(100, Math.round(method.successRate * 0.95 + 10 * 0.05));
                            ALL_METHODS[method.id].successRate = newRate;
                            localStorage.setItem(`method_success_${method.id}`, newRate);
                        } else {
                            updateResultCard(method.id, 'failed', null);
                            log(`‚ùå ${method.name} failed`, 'error');
                            
                            // Update success rate
                            const newRate = Math.max(0, Math.round(method.successRate * 0.95 - 5 * 0.05));
                            ALL_METHODS[method.id].successRate = newRate;
                            localStorage.setItem(`method_success_${method.id}`, newRate);
                        }
                    }
                    
                } catch (error) {
                    log(`Error testing ${method.name}: ${error.message}`, 'error');
                    updateResultCard(method.id, 'failed', null);
                    stats.tested++;
                }
                
                updateStats();
                
                // If we found a working method, we can stop early
                if (stats.working >= 3) {
                    log(`Found ${stats.working} working methods - stopping early`, 'success');
                    break;
                }
            }
            
            // Complete
            if (scanActive) {
                enhancedScanComplete();
            }
        }

        // ============ PROXY DISCOVERY ENGINE ============
        async function startProxyDiscovery() {
            const input = elements.urlInput.value.trim();
            if (!input) {
                log('Please enter a URL', 'error');
                return;
            }
            
            discoveryActive = true;
            elements.discoveryPanel.style.display = 'block';
            elements.discoveryBtn.disabled = true;
            elements.discoveryBtn.textContent = 'üîç DISCOVERING...';
            
            log('Starting proxy discovery...', 'info');
            
            // Show discovery sources
            const sourcesDiv = document.getElementById('proxySources');
            sourcesDiv.innerHTML = '';
            
            Object.entries(DISCOVERY_SOURCES).forEach(([id, source]) => {
                const btn = document.createElement('button');
                btn.className = 'source-btn';
                btn.textContent = source.name;
                btn.dataset.source = id;
                sourcesDiv.appendChild(btn);
            });
            
            // Simulate discovery process
            simulateDiscovery();
        }

        async function simulateDiscovery() {
            const statusEl = document.getElementById('discoveryStatus');
            const proxyListEl = document.getElementById('proxyList');
            
            statusEl.innerHTML = 'üîç Searching Wayback Machine...';
            await delay(1000);
            
            // Simulate finding proxies
            const discoveredProxies = [
                { name: 'Archive.org Proxy', url: 'https://web.archive.org/web/{url}', health: 95, type: 'archive' },
                { name: 'CORS Anywhere', url: 'https://cors-anywhere.herokuapp.com/{url}', health: 70, type: 'cors' },
                { name: 'All Origins', url: 'https://api.allorigins.win/raw?url={url}', health: 85, type: 'api' },
                { name: 'Proxy Crawler', url: 'https://proxy.crawler.dev/?url={url}', health: 60, type: 'crawler' },
                { name: 'Wayback Live', url: 'https://archive.org/wayback/available?url={url}', health: 90, type: 'archive' }
            ];
            
            // Save to localStorage
            localStorage.setItem('discovered_proxies', JSON.stringify(discoveredProxies));
            
            // Display results
            proxyListEl.innerHTML = discoveredProxies.map(proxy => `
                <div style="background:rgba(16,185,129,0.1);border:1px solid #10b981;border-radius:5px;padding:10px;margin:5px 0;">
                    <strong>${proxy.name}</strong><br>
                    <small>${proxy.url.replace('{url}', 'example.com')}</small><br>
                    <span style="color:${proxy.health > 80 ? '#10b981' : proxy.health > 60 ? '#f59e0b' : '#ef4444'}">
                    Health: ${proxy.health}%</span>
                </div>
            `).join('');
            
            statusEl.innerHTML = '‚úÖ Found 5 new proxies!';
            log('Proxy discovery complete - found 5 new proxies', 'success');
            
            // Update discovery button
            elements.discoveryBtn.disabled = false;
            elements.discoveryBtn.textContent = 'üîç FIND PROXIES';
            discoveryActive = false;
        }

        function delay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // ============ FEEDBACK SYSTEM ============
        function setupFeedbackSystem() {
            // Rating buttons
            document.querySelectorAll('.rating-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.rating-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    const rating = this.dataset.rating;
                    const url = elements.urlInput.value.trim();
                    
                    log(`Rated current method: ${rating} stars for ${url}`, 'info');
                });
            });
            
            // Submit feedback
            document.getElementById('submitFeedback').addEventListener('click', function() {
                const url = document.getElementById('feedbackUrl').value;
                const feedback = document.getElementById('feedbackText').value;
                const rating = document.querySelector('.rating-btn.active')?.dataset.rating;
                
                if (!url || !feedback) {
                    alert('Please enter URL and feedback');
                    return;
                }
                
                // Save to localStorage
                const feedbacks = JSON.parse(localStorage.getItem('user_feedbacks') || '[]');
                feedbacks.push({
                    url,
                    feedback,
                    rating: rating || '5',
                    timestamp: new Date().toISOString()
                });
                localStorage.setItem('user_feedbacks', JSON.stringify(feedbacks));
                
                // Clear form
                document.getElementById('feedbackUrl').value = '';
                document.getElementById('feedbackText').value = '';
                
                log('Feedback submitted! Thank you!', 'success');
                updateCommunityTips();
            });
            
            // Load community tips
            updateCommunityTips();
        }

        function updateCommunityTips() {
            const feedbacks = JSON.parse(localStorage.getItem('user_feedbacks') || '[]');
            const tipsEl = document.getElementById('communityTips');
            
            if (feedbacks.length === 0) {
                tipsEl.innerHTML = '<p style="color:#94a3b8;">No community tips yet. Be the first to submit feedback!</p>';
                return;
            }
            
            // Show latest 3 tips
            const recent = feedbacks.slice(-3).reverse();
            tipsEl.innerHTML = recent.map(fb => `
                <div style="background:rgba(96,165,250,0.1);border-radius:5px;padding:10px;margin:10px 0;">
                    <strong>${fb.url}</strong> - ${'‚≠ê'.repeat(fb.rating)}<br>
                    <small>${fb.feedback}</small>
                </div>
            `).join('');
        }

        // ============ HISTORY & STATISTICS ============
        function updateHistoryStats() {
            // Total scans
            const totalScans = parseInt(localStorage.getItem('total_scans') || '0');
            document.getElementById('totalScans').textContent = totalScans;
            
            // Working methods cache
            const cachedMethods = Object.keys(localStorage).filter(key => key.startsWith('method_success_')).length;
            document.getElementById('workingCache').textContent = cachedMethods;
            
            // Average success rate
            const methods = Object.values(ALL_METHODS);
            const avgSuccess = methods.length > 0 ? 
                Math.round(methods.reduce((sum, m) => sum + (parseFloat(m.successRate) || 0), 0) / methods.length) : 0;
            document.getElementById('avgSuccess').textContent = avgSuccess + '%';
            
            // Top method
            const topMethod = methods.reduce((best, current) => 
                (parseFloat(current.successRate) || 0) > (parseFloat(best.successRate) || 0) ? current : best
            );
            document.getElementById('topMethod').textContent = topMethod.name || '-';
            
            // Method ranking
            const rankingEl = document.getElementById('methodRanking');
            const rankedMethods = methods
                .sort((a, b) => (parseFloat(b.successRate) || 0) - (parseFloat(a.successRate) || 0))
                .slice(0, 5);
            
            rankingEl.innerHTML = rankedMethods.map((method, index) => `
                <div style="display:flex;justify-content:space-between;padding:5px 0;border-bottom:1px solid rgba(148,163,184,0.1);">
                    <span>${index + 1}. ${method.name}</span>
                    <span style="color:#60a5fa;">${method.successRate}%</span>
                </div>
            `).join('');
        }

        // ============ TAB SYSTEM ============
        function setupTabSystem() {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.dataset.tab;
                    
                    // Update active tab
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show active content
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    document.getElementById(tabId).classList.add('active');
                    
                    // Update content for specific tabs
                    if (tabId === 'history') {
                        updateHistoryStats();
                    } else if (tabId === 'discovery') {
                        // Update discovery sources
                        const sourcesDiv = document.getElementById('proxySources');
                        sourcesDiv.innerHTML = '';
                        Object.entries(DISCOVERY_SOURCES).forEach(([id, source]) => {
                            const btn = document.createElement('button');
                            btn.className = 'source-btn';
                            btn.textContent = source.name;
                            btn.dataset.source = id;
                            sourcesDiv.appendChild(btn);
                        });
                        
                        // Start discovery button
                        document.getElementById('startDiscovery').addEventListener('click', startProxyDiscovery);
                    } else if (tabId === 'feedback') {
                        updateCommunityTips();
                    }
                });
            });
        }

        // ============ REST OF THE FUNCTIONS ============
        // [All the existing functions from the original code are preserved here]
        // Including: openEmbeddedViewer, closeEmbeddedViewer, setupEmbeddedViewer,
        // testDirectAccess, testNetworkAccess, setupManualMethods, startAutoScan,
        // testMethod, addResultCard, updateResultCard, scanComplete, stopScan,
        // testAllMethods, and all their helper functions

        // EMBEDDED VIEWER FUNCTIONS
        let currentEmbedUrl = '';
        let currentMethod = null;
        let currentOriginalUrl = '';

        function openEmbeddedViewer(method, proxyUrl, originalUrl) {
            currentMethod = method;
            currentEmbedUrl = proxyUrl;
            currentOriginalUrl = originalUrl;
            
            elements.viewerMethodIcon.textContent = method.icon;
            elements.viewerMethodName.textContent = method.name;
            elements.viewerUrl.textContent = ` | ${originalUrl}`;
            
            elements.viewerLoading.style.display = 'block';
            elements.viewerFrame.style.display = 'none';
            
            elements.embedViewer.style.display = 'flex';
            document.body.style.overflow = 'hidden';
            
            setTimeout(() => {
                elements.viewerFrame.src = proxyUrl;
                
                elements.viewerFrame.onload = () => {
                    elements.viewerLoading.style.display = 'none';
                    elements.viewerFrame.style.display = 'block';
                    log(`‚úÖ Loaded ${method.name}`, 'success');
                };
                
                elements.viewerFrame.onerror = () => {
                    elements.viewerLoading.innerHTML = `
                        <div class="spinner"></div>
                        <p>Failed to load. Trying alternative...</p>
                        <p style="font-size:0.9rem;color:#f59e0b;">Some sites block iframes</p>
                    `;
                    log(`‚ö†Ô∏è ${method.name} may be blocking iframes`, 'warning');
                };
            }, 100);
        }

        function closeEmbeddedViewer() {
            elements.embedViewer.style.display = 'none';
            document.body.style.overflow = 'auto';
            elements.viewerFrame.src = 'about:blank';
            currentEmbedUrl = '';
            currentMethod = null;
            currentOriginalUrl = '';
        }

        function setupEmbeddedViewer() {
            elements.viewerCloseBtn.addEventListener('click', closeEmbeddedViewer);
            elements.viewerBackBtn.addEventListener('click', () => closeEmbeddedViewer());
            elements.viewerReloadBtn.addEventListener('click', () => {
                if (currentEmbedUrl) {
                    elements.viewerLoading.style.display = 'block';
                    elements.viewerFrame.style.display = 'none';
                    elements.viewerFrame.src = currentEmbedUrl;
                    log(`‚Üª Reloading ${currentMethod.name}`, 'info');
                }
            });
            elements.viewerNewTabBtn.addEventListener('click', () => {
                if (currentEmbedUrl) {
                    const win = window.open(currentEmbedUrl, '_blank');
                    if (win) log(`‚Üó Opened ${currentMethod.name} in new tab`, 'info');
                }
            });
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && elements.embedViewer.style.display === 'flex') {
                    closeEmbeddedViewer();
                }
            });
            elements.embedViewer.addEventListener('click', (e) => {
                if (e.target === elements.embedViewer) closeEmbeddedViewer();
            });
        }

        // DIRECT TEST
        async function testDirectAccess() {
            const input = elements.urlInput.value.trim();
            if (!input) {
                log('Please enter a URL', 'error');
                return;
            }
            
            const url = formatUrl(input);
            if (!url) {
                log('Invalid URL', 'error');
                return;
            }
            
            log('Testing direct access...', 'info');
            elements.directResult.style.display = 'block';
            elements.directResult.innerHTML = `
                <div style="display:flex;align-items:center;gap:15px;">
                    <div class="spinner" style="width:30px;height:30px;border:3px solid rgba(96,165,250,0.3);border-radius:50%;border-top-color:#60a5fa;animation:spin 1s linear infinite;"></div>
                    <div>
                        <h3 style="margin:0;color:#60a5fa;">Testing Direct Access...</h3>
                        <p style="margin:5px 0 0 0;color:#94a3b8;">Checking if site is blocked</p>
                    </div>
                </div>
            `;
            
            const canAccess = await testNetworkAccess(url);
            
            if (canAccess) {
                elements.directResult.innerHTML = `
                    <div style="display:flex;align-items:center;gap:15px;">
                        <span style="font-size:2rem">‚úÖ</span>
                        <div>
                            <h3 style="margin:0;color:#10b981;">DIRECT ACCESS WORKS!</h3>
                            <p style="margin:5px 0 0 0;color:#94a3b8;">Site is not blocked</p>
                        </div>
                    </div>
                    <button class="use-btn" style="margin-top:15px;background:#8b5cf6;" id="useDirectBtn">üöÄ OPEN IN VIEWER</button>
                `;
                
                document.getElementById('useDirectBtn').addEventListener('click', () => {
                    openEmbeddedViewer({ name: 'Direct Access', icon: 'üéØ' }, url, url);
                    log('Opened direct access in viewer', 'success');
                });
                
                log('‚úÖ Direct access available', 'success');
                directTestResult = true;
            } else {
                elements.directResult.innerHTML = `
                    <div style="display:flex;align-items:center;gap:15px;">
                        <span style="font-size:2rem">‚ùå</span>
                        <div>
                            <h3 style="margin:0;color:#ef4444;">DIRECT ACCESS BLOCKED</h3>
                            <p style="margin:5px 0 0 0;color:#94a3b8;">Site is blocked. Try proxy methods.</p>
                        </div>
                    </div>
                `;
                log('‚ùå Direct access blocked', 'error');
                directTestResult = false;
            }
            
            updateStats();
            return canAccess;
        }

        async function testNetworkAccess(url) {
            return new Promise((resolve) => {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 3000);
                
                const img = new Image();
                img.onload = () => {
                    clearTimeout(timeoutId);
                    resolve(true);
                };
                img.onerror = () => {
                    clearTimeout(timeoutId);
                    resolve(false);
                };
                img.src = url + '?test=' + Date.now();
                
                setTimeout(() => {
                    clearTimeout(timeoutId);
                    resolve(false);
                }, 3000);
            });
        }

        // MANUAL METHOD BUTTONS
        function setupManualMethods() {
            document.querySelectorAll('.method-card').forEach(card => {
                card.addEventListener('click', () => {
                    const methodId = card.dataset.method;
                    const method = ALL_METHODS[methodId];
                    if (!method) return;
                    
                    const input = elements.urlInput.value.trim();
                    if (!input) {
                        log('Enter URL first', 'error');
                        return;
                    }
                    
                    const url = formatUrl(input);
                    if (!url) {
                        log('Invalid URL', 'error');
                        return;
                    }
                    
                    log(`Using ${method.name}...`, 'info');
                    card.style.transform = 'scale(0.95)';
                    card.style.borderColor = '#f59e0b';
                    setTimeout(() => {
                        card.style.transform = '';
                        card.style.borderColor = '';
                    }, 300);
                    
                    const proxyUrls = method.execute(url);
                    if (proxyUrls && proxyUrls[0]) {
                        openEmbeddedViewer(method, proxyUrls[0], url);
                    }
                });
            });
        }

        // AUTO SCAN
        async function startAutoScan() {
            if (scanActive) {
                stopScan();
                return;
            }
            
            const input = elements.urlInput.value.trim();
            if (!input) {
                log('Please enter a URL', 'error');
                return;
            }
            
            const url = formatUrl(input);
            if (!url) {
                log('Invalid URL', 'error');
                return;
            }
            
            // Increment scan counter
            const totalScans = parseInt(localStorage.getItem('total_scans') || '0');
            localStorage.setItem('total_scans', (totalScans + 1).toString());
            
            scanActive = true;
            scanResults = {};
            stats.tested = 0;
            stats.working = 0;
            elements.resultCards.innerHTML = '';
            elements.stopBtn.style.display = 'block';
            
            elements.autoBtn.disabled = true;
            elements.autoBtn.textContent = '‚è≥ SCANNING...';
            elements.autoBtn.className = 'main-btn stop';
            
            log(`üöÄ Starting AUTO SCAN for: ${url}`, 'info');
            
            const directWorks = await testDirectAccess();
            
            if (directWorks) {
                if (!confirm('Direct access works! Continue testing proxy methods?')) {
                    stopScan();
                    return;
                }
            }
            
            const methodIds = Object.keys(ALL_METHODS);
            const totalMethods = methodIds.length;
            
            for (let i = 0; i < totalMethods; i++) {
                if (!scanActive) break;
                
                const methodId = methodIds[i];
                const method = ALL_METHODS[methodId];
                
                const progress = updateProgress(i + 1, totalMethods);
                elements.progressText.textContent = `${Math.round(progress)}% - Testing ${method.name}...`;
                
                addResultCard(method, 'testing', null);
                
                try {
                    const proxyUrls = method.execute(url);
                    const testUrl = proxyUrls && proxyUrls[0];
                    
                    if (testUrl) {
                        const result = await testMethod(testUrl);
                        
                        scanResults[methodId] = {
                            method: method,
                            working: result,
                            url: testUrl
                        };
                        
                        stats.tested++;
                        
                        if (result) {
                            stats.working++;
                            updateResultCard(methodId, 'working', testUrl);
                            log(`‚úÖ ${method.name} works`, 'success');
                        } else {
                            updateResultCard(methodId, 'failed', null);
                            log(`‚ùå ${method.name} failed`, 'error');
                        }
                    } else {
                        updateResultCard(methodId, 'failed', null);
                        stats.tested++;
                        log(`‚ùå ${method.name} - No URLs generated`, 'error');
                    }
                    
                } catch (error) {
                    log(`Error testing ${method.name}: ${error.message}`, 'error');
                    updateResultCard(methodId, 'failed', null);
                    stats.tested++;
                }
                
                updateStats();
            }
            
            if (scanActive) {
                scanComplete();
            }
        }

        async function testMethod(url) {
            return new Promise((resolve) => {
                const testFrame = document.createElement('iframe');
                testFrame.style.cssText = 'position:fixed;top:-1000px;left:-1000px;width:1px;height:1px;opacity:0;pointer-events:none;';
                document.body.appendChild(testFrame);
                
                testFrame.src = url;
                
                setTimeout(() => {
                    try {
                        const worked = testFrame.contentWindow && testFrame.contentWindow.location.href !== 'about:blank';
                        document.body.removeChild(testFrame);
                        resolve(worked);
                    } catch(e) {
                        try {
                            document.body.removeChild(testFrame);
                        } catch {}
                        resolve(false);
                    }
                }, 2000);
            });
        }

        function addResultCard(method, status, url) {
            const card = document.createElement('div');
            card.className = `result-card ${status}`;
            card.id = `card-${method.name.replace(/\s+/g, '-').toLowerCase()}`;
            
            const statusText = status === 'testing' ? 'TESTING...' : 
                             status === 'working' ? 'WORKS' : 'FAILED';
            
            card.innerHTML = `
                <div class="result-info">
                    <div style="display:flex;align-items:center;gap:10px;">
                        <span style="font-size:1.2rem">${method.icon}</span>
                        <div>
                            <div style="font-weight:bold;">${method.name}</div>
                            <div style="font-size:0.9rem;color:#94a3b8;">${statusText}</div>
                        </div>
                    </div>
                    ${url ? `<button class="use-btn" data-url="${url}" data-method="${method.name}">VIEW</button>` : ''}
                </div>
            `;
            
            elements.resultCards.appendChild(card);
            
            if (url) {
                setTimeout(() => {
                    const viewBtn = card.querySelector('.use-btn');
                    if (viewBtn) {
                        viewBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            const methodName = viewBtn.dataset.method;
                            const method = Object.values(ALL_METHODS).find(m => m.name === methodName);
                            if (method) {
                                openEmbeddedViewer(method, url, elements.urlInput.value.trim());
                            }
                        });
                    }
                }, 100);
            }
            
            card.addEventListener('click', () => {
                if (url) {
                    const methodName = card.querySelector('.use-btn')?.dataset.method;
                    const method = Object.values(ALL_METHODS).find(m => m.name === methodName);
                    if (method) {
                        openEmbeddedViewer(method, url, elements.urlInput.value.trim());
                    }
                }
            });
            
            return card;
        }

        function updateResultCard(methodId, status, url) {
            const method = ALL_METHODS[methodId];
            const cardId = `card-${method.name.replace(/\s+/g, '-').toLowerCase()}`;
            const card = document.getElementById(cardId);
            
            if (!card) return;
            
            card.className = `result-card ${status}`;
            
            const statusText = status === 'working' ? 'WORKS' : 'FAILED';
            
            card.innerHTML = `
                <div class="result-info">
                    <div style="display:flex;align-items:center;gap:10px;">
                        <span style="font-size:1.2rem">${method.icon}</span>
                        <div>
                            <div style="font-weight:bold;">${method.name}</div>
                            <div style="font-size:0.9rem;color:#94a3b8;">${statusText}</div>
                        </div>
                    </div>
                    ${url ? `<button class="use-btn" data-url="${url}" data-method="${method.name}">VIEW</button>` : ''}
                </div>
            `;
            
            if (url) {
                setTimeout(() => {
                    const viewBtn = card.querySelector('.use-btn');
                    if (viewBtn) {
                        viewBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            const methodName = viewBtn.dataset.method;
                            const method = Object.values(ALL_METHODS).find(m => m.name === methodName);
                            if (method) {
                                openEmbeddedViewer(method, url, elements.urlInput.value.trim());
                            }
                        });
                    }
                    
                    card.addEventListener('click', () => {
                        const method = ALL_METHODS[methodId];
                        if (method) {
                            openEmbeddedViewer(method, url, elements.urlInput.value.trim());
                        }
                    });
                }, 100);
            }
        }

        function enhancedScanComplete() {
            scanActive = false;
            
            const worked = stats.working;
            const direct = directTestResult;
            
            elements.enhancedBtn.disabled = false;
            elements.enhancedBtn.textContent = 'üöÄ ENHANCED SCAN';
            elements.enhancedBtn.className = 'main-btn enhanced';
            elements.stopBtn.style.display = 'none';
            
            if (direct === true) {
                elements.progressText.textContent = '‚úÖ Direct access works!';
                log('Enhanced scan complete: Direct access available', 'success');
            } else if (worked > 0) {
                elements.progressText.textContent = `‚úÖ Found ${worked} working methods`;
                log(`Enhanced scan complete: ${worked} methods work (Success rate: ${stats.successRate}%)`, 'success');
                
                // Recommend best method
                const bestMethod = Object.values(scanResults)
                    .filter(r => r.working)
                    .reduce((best, current) => 
                        (current.method.successRate || 0) > (best.method.successRate || 0) ? current : best
                    );
                
                if (bestMethod) {
                    log(`üèÜ Recommended method: ${bestMethod.method.name} (${bestMethod.method.successRate}% success rate)`, 'success');
                }
            } else {
                elements.progressText.textContent = '‚ùå No methods work';
                log('Enhanced scan complete: No methods work', 'error');
            }
        }

        function scanComplete() {
            scanActive = false;
            
            const worked = stats.working;
            const direct = directTestResult;
            
            elements.autoBtn.disabled = false;
            elements.autoBtn.textContent = 'ü§ñ AUTO SCAN';
            elements.autoBtn.className = 'main-btn auto';
            elements.stopBtn.style.display = 'none';
            
            if (direct === true) {
                elements.progressText.textContent = '‚úÖ Direct access works!';
                log('Scan complete: Direct access available', 'success');
            } else if (worked > 0) {
                elements.progressText.textContent = `‚úÖ ${worked} methods work`;
                log(`Scan complete: ${worked} methods work`, 'success');
            } else {
                elements.progressText.textContent = '‚ùå No methods work';
                log('Scan complete: No methods work', 'error');
            }
        }

        function stopScan() {
            scanActive = false;
            elements.autoBtn.disabled = false;
            elements.autoBtn.textContent = 'ü§ñ AUTO SCAN';
            elements.autoBtn.className = 'main-btn auto';
            elements.enhancedBtn.disabled = false;
            elements.enhancedBtn.textContent = 'üöÄ ENHANCED SCAN';
            elements.enhancedBtn.className = 'main-btn enhanced';
            elements.stopBtn.style.display = 'none';
            elements.progressText.textContent = 'Scan stopped';
            log('Scan stopped by user', 'warning');
        }

        // TEST ALL METHODS
        function testAllMethods() {
            const input = elements.urlInput.value.trim();
            if (!input) {
                log('Enter URL first', 'error');
                return;
            }
            
            const url = formatUrl(input);
            if (!url) {
                log('Invalid URL', 'error');
                return;
            }
            
            log('Testing ALL methods...', 'info');
            elements.openAllBtn.disabled = true;
            
            let count = 0;
            let working = 0;
            const methodIds = Object.keys(ALL_METHODS);
            
            methodIds.forEach((methodId, index) => {
                setTimeout(() => {
                    const method = ALL_METHODS[methodId];
                    const proxyUrls = method.execute(url);
                    
                    if (proxyUrls && proxyUrls[0]) {
                        const testFrame = document.createElement('iframe');
                        testFrame.style.display = 'none';
                        document.body.appendChild(testFrame);
                        
                        testFrame.src = proxyUrls[0];
                        count++;
                        
                        setTimeout(() => {
                            try {
                                if (testFrame.contentWindow && testFrame.contentWindow.location.href !== 'about:blank') {
                                    working++;
                                    log(`‚úÖ ${method.name} works`, 'success');
                                } else {
                                    log(`‚ùå ${method.name} failed`, 'error');
                                }
                            } catch(e) {
                                log(`‚ö†Ô∏è ${method.name} - Could not test`, 'warning');
                            }
                            
                            if (testFrame.parentNode) {
                                document.body.removeChild(testFrame);
                            }
                        }, 1500);
                    }
                    
                    const progress = ((index + 1) / methodIds.length) * 100;
                    elements.progressFill.style.width = progress + '%';
                    elements.progressText.textContent = `${Math.round(progress)}% - Testing...`;
                    
                    if (index === methodIds.length - 1) {
                        setTimeout(() => {
                            elements.openAllBtn.disabled = false;
                            elements.progressText.textContent = 'Complete';
                            log(`‚úÖ Tested ${count} methods: ${working} work`, 'success');
                            
                            elements.directResult.style.display = 'block';
                            elements.directResult.innerHTML = `
                                <div style="text-align:center;padding:20px;">
                                    <h3 style="color:#60a5fa;margin-bottom:15px;">üìä Test Results</h3>
                                    <div style="display:flex;justify-content:center;gap:20px;margin:20px 0;">
                                        <div style="text-align:center;">
                                            <div style="font-size:2.5rem;color:#10b981;">${working}</div>
                                            <div style="color:#94a3b8;">Working</div>
                                        </div>
                                        <div style="text-align:center;">
                                            <div style="font-size:2.5rem;color:#ef4444;">${count - working}</div>
                                            <div style="color:#94a3b8;">Failed</div>
                                        </div>
                                    </div>
                                    <p style="color:#94a3b8;">${working} out of ${count} methods work</p>
                                    ${working > 0 ? '<p style="color:#94a3b8;margin-top:10px;">Click on working methods to use them!</p>' : ''}
                                </div>
                            `;
                        }, 2000);
                    }
                }, index * 300);
            });
        }

        // ============ INITIALIZATION ============
        function init() {
            // Setup all systems
            setupEmbeddedViewer();
            setupManualMethods();
            setupTabSystem();
            setupFeedbackSystem();
            
            // Event listeners
            elements.autoBtn.addEventListener('click', startAutoScan);
            elements.enhancedBtn.addEventListener('click', startEnhancedScan);
            elements.directBtn.addEventListener('click', testDirectAccess);
            elements.discoveryBtn.addEventListener('click', startProxyDiscovery);
            elements.openAllBtn.addEventListener('click', testAllMethods);
            elements.stopBtn.addEventListener('click', stopScan);
            
            // Quick links
            document.querySelectorAll('.quick-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    elements.urlInput.value = btn.dataset.url;
                    log(`Loaded: ${btn.dataset.url}`, 'info');
                });
            });
            
            // URL input
            elements.urlInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    startEnhancedScan();
                }
            });
            
            // Initial stats
            updateStats();
            updateHistoryStats();
            
            // Welcome
            log('üöÄ Enhanced Portal v2.0 loaded with ALL upgrades', 'success');
            log('‚Ä¢ Wayback Focus ‚Ä¢ Proxy Discovery ‚Ä¢ Smart Selection ‚Ä¢', 'info');
            log('‚Ä¢ Success Tracking ‚Ä¢ Community Feedback ‚Ä¢ History Stats ‚Ä¢', 'info');
            
            // Auto-focus
            elements.urlInput.focus();
            elements.urlInput.select();
        }

        // Start everything
        init();
    </script>
</body>
</html>
