<!DOCTYPE html>
<html>
<head>
    <title>Complete Portal</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #e2e8f0;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(30, 41, 59, 0.8);
            border-radius: 15px;
            border: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        h1 {
            font-size: 2.5rem;
            color: #60a5fa;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #94a3b8;
        }
        
        .search-section {
            background: rgba(30, 41, 59, 0.8);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        #urlInput {
            flex: 1;
            padding: 15px;
            font-size: 16px;
            border: 2px solid #475569;
            border-radius: 10px;
            background: #1e293b;
            color: #e2e8f0;
        }
        
        #urlInput:focus {
            outline: none;
            border-color: #60a5fa;
        }
        
        .main-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .main-btn {
            padding: 15px 25px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            flex: 1;
            min-width: 200px;
            font-weight: bold;
        }
        
        .main-btn.auto {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        
        .main-btn.direct {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
        }
        
        .main-btn.stop {
            background: linear-gradient(135deg, #ef4444, #b91c1c);
        }
        
        .main-btn.stealth {
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
        }
        
        .main-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .main-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .quick-links {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .quick-btn {
            padding: 8px 15px;
            background: #475569;
            color: #e2e8f0;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .quick-btn:hover {
            background: #60a5fa;
            color: white;
        }
        
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
        }
        
        @media (max-width: 900px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
        }
        
        .manual-methods {
            background: rgba(30, 41, 59, 0.8);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(148, 163, 184, 0.2);
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .methods-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .method-card {
            background: rgba(15, 23, 42, 0.8);
            border: 2px solid #475569;
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .method-card:hover {
            border-color: #60a5fa;
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(96, 165, 250, 0.2);
        }
        
        .method-card:active {
            transform: translateY(-2px);
        }
        
        .method-card.advanced {
            border-color: #8b5cf6;
            background: rgba(139, 92, 246, 0.1);
        }
        
        .method-card.stealth {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }
        
        .method-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .method-name {
            font-weight: bold;
            margin-bottom: 5px;
            color: #e2e8f0;
        }
        
        .method-desc {
            font-size: 0.85rem;
            color: #94a3b8;
            line-height: 1.4;
        }
        
        .scan-results {
            background: rgba(30, 41, 59, 0.8);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .section-title {
            color: #60a5fa;
            font-size: 1.3rem;
            font-weight: bold;
        }
        
        .stats {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .stat {
            background: rgba(15, 23, 42, 0.8);
            padding: 15px;
            border-radius: 10px;
            flex: 1;
            min-width: 120px;
            text-align: center;
            border: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #60a5fa;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #94a3b8;
        }
        
        .progress-container {
            margin: 20px 0;
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #475569;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #3b82f6);
            width: 0%;
            transition: width 0.3s;
        }
        
        .result-cards {
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .result-card {
            background: rgba(15, 23, 42, 0.8);
            border: 2px solid #475569;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .result-card:hover {
            border-color: #60a5fa;
        }
        
        .result-card.working {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }
        
        .result-card.failed {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }
        
        .result-card.testing {
            border-color: #f59e0b;
            background: rgba(245, 158, 11, 0.1);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .result-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .use-btn {
            padding: 8px 15px;
            background: #10b981;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .use-btn:hover {
            background: #0da271;
        }
        
        .log-box {
            background: rgba(15, 23, 42, 0.8);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
            border: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        .log-entry {
            margin-bottom: 5px;
            padding: 5px 0;
            border-bottom: 1px solid rgba(148, 163, 184, 0.1);
        }
        
        .success { color: #10b981; }
        .error { color: #ef4444; }
        .info { color: #60a5fa; }
        .warning { color: #f59e0b; }
        
        .category-title {
            color: #94a3b8;
            font-size: 1.1rem;
            margin: 25px 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        .category-title:first-child {
            margin-top: 0;
        }
        
        .direct-result {
            background: rgba(139, 92, 246, 0.2);
            border: 2px solid #8b5cf6;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        /* EMBED VIEWER STYLES */
        .embed-viewer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.95);
            z-index: 1000;
            display: none;
            flex-direction: column;
            backdrop-filter: blur(10px);
        }
        
        .viewer-header {
            background: rgba(30, 41, 59, 0.9);
            padding: 15px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        .viewer-title {
            font-size: 1.2rem;
            color: #60a5fa;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .viewer-controls {
            display: flex;
            gap: 10px;
        }
        
        .control-btn {
            padding: 8px 16px;
            background: #475569;
            color: #e2e8f0;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .control-btn:hover {
            background: #60a5fa;
            color: white;
        }
        
        .control-btn.close {
            background: #ef4444;
            color: white;
        }
        
        .control-btn.close:hover {
            background: #dc2626;
        }
        
        .control-btn.stealth {
            background: #10b981;
            color: white;
        }
        
        .control-btn.stealth:hover {
            background: #0da271;
        }
        
        .viewer-content {
            flex: 1;
            position: relative;
            overflow: hidden;
        }
        
        .viewer-frame {
            width: 100%;
            height: 100%;
            border: none;
            background: white;
        }
        
        .viewer-loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: #60a5fa;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(96, 165, 250, 0.3);
            border-radius: 50%;
            border-top-color: #60a5fa;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .viewer-method-info {
            background: rgba(15, 23, 42, 0.8);
            padding: 10px 15px;
            border-top: 1px solid rgba(148, 163, 184, 0.2);
            font-size: 0.9rem;
            color: #94a3b8;
        }
        
        .iframe-container {
            position: relative;
            width: 100%;
            height: 100%;
        }
        
        .advanced-options {
            background: rgba(15, 23, 42, 0.8);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            border: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        .option-row {
            display: flex;
            gap: 15px;
            margin-bottom: 10px;
            align-items: center;
        }
        
        .option-label {
            min-width: 120px;
            color: #94a3b8;
        }
        
        .option-input {
            flex: 1;
            padding: 8px 12px;
            background: #1e293b;
            border: 1px solid #475569;
            border-radius: 5px;
            color: #e2e8f0;
        }
        
        .option-checkbox {
            margin-right: 8px;
        }
        
        .toggle-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .toggle-switch {
            position: relative;
            width: 50px;
            height: 24px;
        }
        
        .toggle-checkbox {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #475569;
            transition: .4s;
            border-radius: 34px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        .toggle-checkbox:checked + .toggle-slider {
            background-color: #10b981;
        }
        
        .toggle-checkbox:checked + .toggle-slider:before {
            transform: translateX(26px);
        }
        
        .method-tag {
            display: inline-block;
            padding: 2px 8px;
            background: #475569;
            color: #e2e8f0;
            border-radius: 10px;
            font-size: 0.7rem;
            margin-left: 5px;
        }
        
        .tag-stealth { background: #10b981; }
        .tag-advanced { background: #8b5cf6; }
        .tag-proxy { background: #3b82f6; }
    </style>
</head>
<body>
    <!-- Embed Viewer (hidden by default) -->
    <div class="embed-viewer" id="embedViewer">
        <div class="viewer-header">
            <div class="viewer-title">
                <span id="viewerMethodIcon">üåê</span>
                <span id="viewerMethodName">Loading...</span>
                <span style="color:#94a3b8;font-size:0.9rem;" id="viewerUrl"></span>
                <span id="viewerStealthBadge" style="display:none;background:#10b981;color:white;padding:2px 8px;border-radius:10px;font-size:0.7rem;">STEALTH</span>
            </div>
            <div class="viewer-controls">
                <button class="control-btn stealth" id="viewerStealthBtn" title="Toggle stealth mode">üï∂Ô∏è Stealth</button>
                <button class="control-btn" id="viewerBackBtn">‚Üê Back</button>
                <button class="control-btn" id="viewerReloadBtn">‚Üª Reload</button>
                <button class="control-btn" id="viewerNewTabBtn">‚Üó New Tab</button>
                <button class="control-btn close" id="viewerCloseBtn">‚úï Close</button>
            </div>
        </div>
        <div class="viewer-content" id="viewerContent">
            <div class="viewer-loading" id="viewerLoading">
                <div class="spinner"></div>
                <p>Loading embedded viewer...</p>
                <p id="viewerLoadingDetails" style="font-size:0.9rem;color:#94a3b8;">Initializing stealth mode</p>
            </div>
            <div class="iframe-container">
                <iframe class="viewer-frame" id="viewerFrame" sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox"></iframe>
            </div>
        </div>
        <div class="viewer-method-info" id="viewerMethodInfo">
            Using proxy method. Site is loaded discreetly in this frame.
        </div>
    </div>
    
    <div class="container">
        <header>
            <h1>üîì Complete Portal</h1>
            <p class="subtitle">Advanced Bypass Methods + Stealth Mode</p>
        </header>
        
        <div class="search-section">
            <div class="search-box">
                <input type="text" id="urlInput" placeholder="Enter website URL (e.g., youtube.com)" value="youtube.com">
                <button class="main-btn auto" id="autoBtn">ü§ñ AUTO SCAN</button>
            </div>
            
            <div class="main-buttons">
                <button class="main-btn direct" id="directBtn">üéØ DIRECT TEST</button>
                <button class="main-btn stealth" id="stealthBtn">üï∂Ô∏è STEALTH MODE</button>
                <button class="main-btn" id="openAllBtn">üöÄ TEST ALL METHODS</button>
            </div>
            
            <div class="quick-links">
                <button class="quick-btn" data-url="youtube.com">YouTube</button>
                <button class="quick-btn" data-url="reddit.com">Reddit</button>
                <button class="quick-btn" data-url="twitter.com">Twitter</button>
                <button class="quick-btn" data-url="coolmathgames.com">CoolMath</button>
                <button class="quick-btn" data-url="discord.com">Discord</button>
                <button class="quick-btn" data-url="netflix.com">Netflix</button>
                <button class="quick-btn" data-url="instagram.com">Instagram</button>
                <button class="quick-btn" data-url="spotify.com">Spotify</button>
            </div>
            
            <div class="advanced-options">
                <h3 style="color:#60a5fa;margin-bottom:15px;">‚ö° Advanced Options</h3>
                <div class="option-row">
                    <div class="option-label">User Agent:</div>
                    <select class="option-input" id="userAgentSelect">
                        <option value="random">Random Browser</option>
                        <option value="chrome">Chrome (Latest)</option>
                        <option value="firefox">Firefox (Latest)</option>
                        <option value="safari">Safari (Mac)</option>
                        <option value="mobile">Mobile Chrome</option>
                        <option value="custom">Custom...</option>
                    </select>
                </div>
                <div class="option-row">
                    <div class="option-label">Referrer:</div>
                    <select class="option-input" id="referrerSelect">
                        <option value="google">Google Search</option>
                        <option value="facebook">Facebook</option>
                        <option value="twitter">Twitter</option>
                        <option value="direct">Direct (None)</option>
                        <option value="random">Random</option>
                    </select>
                </div>
                <div class="option-row">
                    <div class="toggle-container">
                        <input type="checkbox" id="enableStealth" class="toggle-checkbox" checked>
                        <label for="enableStealth" class="toggle-slider"></label>
                        <span>Enable Stealth Mode</span>
                    </div>
                    <div class="toggle-container">
                        <input type="checkbox" id="randomizeHeaders" class="toggle-checkbox">
                        <label for="randomizeHeaders" class="toggle-slider"></label>
                        <span>Randomize Headers</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="content-wrapper">
            <!-- LEFT SIDE: ADVANCED METHODS -->
            <div class="manual-methods">
                <h2 class="section-title">‚ö° Advanced Bypass Methods</h2>
                <p style="color:#94a3b8;margin-bottom:20px;">Click any method to open in stealth viewer</p>
                
                <div class="category-title">üõ°Ô∏è Stealth Proxies <span class="method-tag tag-stealth">HARD TO DETECT</span></div>
                <div class="methods-grid">
                    <div class="method-card stealth" data-method="corporate">
                        <div class="method-icon">üè¢</div>
                        <div class="method-name">Corporate Proxy</div>
                        <div class="method-desc">Mimics corporate network traffic</div>
                    </div>
                    
                    <div class="method-card stealth" data-method="educational">
                        <div class="method-icon">üéì</div>
                        <div class="method-name">Educational Tunnel</div>
                        <div class="method-desc">School/university proxy style</div>
                    </div>
                    
                    <div class="method-card stealth" data-method="cloudflare">
                        <div class="method-icon">‚òÅÔ∏è</div>
                        <div class="method-name">CloudFlare Worker</div>
                        <div class="method-desc">CF Worker proxy bypass</div>
                    </div>
                    
                    <div class="method-card stealth" data-method="websocket">
                        <div class="method-icon">üîå</div>
                        <div class="method-name">WS Tunnel</div>
                        <div class="method-desc">WebSocket full tunnel</div>
                    </div>
                </div>
                
                <div class="category-title">üåê Smart Proxies <span class="method-tag tag-proxy">AUTO-ROTATING</span></div>
                <div class="methods-grid">
                    <div class="method-card" data-method="translate">
                        <div class="method-icon">üåê</div>
                        <div class="method-name">Google Translate+</div>
                        <div class="method-desc">Enhanced Google proxy</div>
                    </div>
                    
                    <div class="method-card" data-method="archive">
                        <div class="method-icon">üìö</div>
                        <div class="method-name">Archive Smart</div>
                        <div class="method-desc">Multiple archive sources</div>
                    </div>
                    
                    <div class="method-card" data-method="mobile">
                        <div class="method-icon">üì±</div>
                        <div class="method-name">Mobile Optimized</div>
                        <div class="method-desc">Mobile-first rendering</div>
                    </div>
                    
                    <div class="method-card" data-method="amp">
                        <div class="method-icon">‚ö°</div>
                        <div class="method-name">AMP Accelerated</div>
                        <div class="method-desc">Google AMP networks</div>
                    </div>
                </div>
                
                <div class="category-title">üî¨ Advanced Techniques <span class="method-tag tag-advanced">EXPERIMENTAL</span></div>
                <div class="methods-grid">
                    <div class="method-card advanced" data-method="fragment">
                        <div class="method-icon">üß©</div>
                        <div class="method-name">Fragment Loader</div>
                        <div class="method-desc">Load site in pieces</div>
                    </div>
                    
                    <div class="method-card advanced" data-method="xhr">
                        <div class="method-icon">üì°</div>
                        <div class="method-name">XHR Proxy</div>
                        <div class="method-desc">AJAX-based loading</div>
                    </div>
                    
                    <div class="method-card advanced" data-method="recursive">
                        <div class="method-icon">üåÄ</div>
                        <div class="method-name">Recursive Proxy</div>
                        <div class="method-desc">Chain multiple proxies</div>
                    </div>
                    
                    <div class="method-card advanced" data-method="p2p">
                        <div class="method-icon">ü§ù</div>
                        <div class="method-name">P2P Network</div>
                        <div class="method-desc">Distributed loading</div>
                    </div>
                </div>
                
                <div class="category-title">üîß Utility Methods</div>
                <div class="methods-grid">
                    <div class="method-card" data-method="reader">
                        <div class="method-icon">üìñ</div>
                        <div class="method-name">Reader View Pro</div>
                        <div class="method-desc">Enhanced reading mode</div>
                    </div>
                    
                    <div class="method-card" data-method="pdf">
                        <div class="method-icon">üìë</div>
                        <div class="method-name">PDF Export</div>
                        <div class="method-desc">Convert to printable PDF</div>
                    </div>
                    
                    <div class="method-card" data-method="textise">
                        <div class="method-icon">üìÑ</div>
                        <div class="method-name">Text Only</div>
                        <div class="method-desc">Stripped down content</div>
                    </div>
                    
                    <div class="method-card" data-method="mirror">
                        <div class="method-icon">ü™û</div>
                        <div class="method-name">Site Mirror</div>
                        <div class="method-desc">Create local copy</div>
                    </div>
                </div>
            </div>
            
            <!-- RIGHT SIDE: AUTO SCAN RESULTS -->
            <div class="scan-results">
                <div class="results-header">
                    <h2 class="section-title">üìä Scan Results & Live Preview</h2>
                    <button class="main-btn stop" id="stopBtn" style="display:none;">‚èπÔ∏è STOP</button>
                </div>
                
                <div class="direct-result" id="directResult" style="display:none;">
                    <!-- Direct test result appears here -->
                </div>
                
                <div class="stats">
                    <div class="stat">
                        <div class="stat-value" id="totalMethods">16</div>
                        <div class="stat-label">Total Methods</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="testedMethods">0</div>
                        <div class="stat-label">Tested</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="workingMethods">0</div>
                        <div class="stat-label">Working</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="stealthScore">üï∂Ô∏è</div>
                        <div class="stat-label">Stealth</div>
                    </div>
                </div>
                
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div id="progressText" style="text-align:center;margin-top:5px;color:#94a3b8;">
                        Ready to scan...
                    </div>
                </div>
                
                <!-- Stealth Status -->
                <div style="background: rgba(16, 185, 129, 0.1); border-radius: 10px; padding: 15px; margin: 15px 0; border: 1px solid rgba(16, 185, 129, 0.3);">
                    <div style="display:flex; align-items:center; gap:10px; color:#10b981;">
                        <span style="font-size:1.5rem;">üï∂Ô∏è</span>
                        <div>
                            <div style="font-weight:bold;">Stealth Mode Active</div>
                            <div style="font-size:0.9rem;">Methods will use enhanced bypass techniques</div>
                        </div>
                    </div>
                </div>
                
                <div class="result-cards" id="resultCards">
                    <!-- Scan result cards appear here -->
                </div>
                
                <div class="log-box" id="logBox">
                    <div class="log-entry info">Advanced Portal loaded. Stealth mode enabled.</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============ ENHANCED METHOD LIBRARY ============
        const ALL_METHODS = {
            // Stealth Proxies
            corporate: {
                name: 'Corporate Proxy',
                icon: 'üè¢',
                category: 'stealth',
                execute: (url, options = {}) => {
                    const clean = url.replace(/^https?:\/\//, '');
                    const encoded = encodeURIComponent(url);
                    
                    // Corporate proxy URLs (looks like legit corporate traffic)
                    return [
                        `https://corporate-proxy-worker.glitch.me/proxy?url=${encoded}`,
                        `https://secure-proxy-service.vercel.app/api/proxy?url=${encoded}&type=corporate`,
                        `https://biz-proxy-${Date.now().toString(36)}.workers.dev/?url=${encoded}`
                    ];
                },
                stealth: true
            },
            
            educational: {
                name: 'Educational Tunnel',
                icon: 'üéì',
                category: 'stealth',
                execute: (url, options = {}) => {
                    const encoded = encodeURIComponent(url);
                    const timestamp = Date.now();
                    
                    // Educational institution style proxies
                    return [
                        `https://edu-proxy-${timestamp % 1000}.pages.dev/?url=${encoded}`,
                        `https://library-access-proxy.glitch.me/proxy?url=${encoded}&ref=edu`,
                        `https://academic-bypass.vercel.app/api/proxy?url=${encoded}`
                    ];
                },
                stealth: true
            },
            
            cloudflare: {
                name: 'CloudFlare Worker',
                icon: '‚òÅÔ∏è',
                category: 'stealth',
                execute: (url, options = {}) => {
                    const encoded = encodeURIComponent(url);
                    // CloudFlare Worker proxies (hard to detect)
                    return [
                        `https://cfw-proxy.${Math.random().toString(36).substr(2, 8)}.workers.dev/?url=${encoded}`,
                        `https://bypass-cf.vercel.app/api/proxy?url=${encoded}`,
                        `https://worker-proxy-template.${Math.random().toString(36).substr(2, 6)}.workers.dev/${encoded}`
                    ];
                },
                stealth: true
            },
            
            websocket: {
                name: 'WS Tunnel',
                icon: 'üîå',
                category: 'stealth',
                execute: (url, options = {}) => {
                    const encoded = encodeURIComponent(url);
                    // WebSocket tunnel proxies
                    return [
                        `https://ws-tunnel-proxy.glitch.me/tunnel?url=${encoded}`,
                        `https://websocket-bypass.vercel.app/api/ws?url=${encoded}`,
                        `https://tunnel-proxy-${Date.now().toString(36)}.workers.dev/?url=${encoded}&mode=ws`
                    ];
                },
                stealth: true
            },
            
            // Smart Proxies
            translate: {
                name: 'Google Translate+',
                icon: 'üåê',
                category: 'proxy',
                execute: (url, options = {}) => {
                    const encoded = encodeURIComponent(url);
                    // Multiple Google Translate variants
                    return [
                        `https://translate.google.com/translate?hl=en&sl=auto&tl=en&u=${encoded}&client=webapp`,
                        `https://translate.googleusercontent.com/translate_p?hl=en&sl=auto&tl=en&u=${encoded}`,
                        `https://www.google.com/translate?langpair=auto|en&u=${encoded}`
                    ];
                }
            },
            
            archive: {
                name: 'Archive Smart',
                icon: 'üìö',
                category: 'proxy',
                execute: (url, options = {}) => {
                    const clean = url.replace(/^https?:\/\//, '');
                    // Multiple archive sources with different dates
                    const dates = ['2023', '2022', '2021', '2020'];
                    const date = dates[Math.floor(Math.random() * dates.length)];
                    return [
                        `https://web.archive.org/web/${date}0000000000*/${url}`,
                        `https://archive.is/${clean}`,
                        `https://archive.today/${clean}`,
                        `https://web.archive.org/web/2/${url}`
                    ];
                }
            },
            
            mobile: {
                name: 'Mobile Optimized',
                icon: 'üì±',
                category: 'proxy',
                execute: (url, options = {}) => {
                    const clean = url.replace(/^https?:\/\//, '');
                    // Mobile-optimized variants
                    return [
                        `https://m.${clean}`,
                        `https://mobile.${clean}`,
                        `https://lite.${clean}`,
                        `https://www.google.com/amp/s/${clean}`
                    ];
                }
            },
            
            amp: {
                name: 'AMP Accelerated',
                icon: '‚ö°',
                category: 'proxy',
                execute: (url, options = {}) => {
                    const clean = url.replace(/^https?:\/\//, '');
                    // AMP cache variants
                    return [
                        `https://www.google.com/amp/s/${clean}`,
                        `https://cdn.ampproject.org/c/${url}`,
                        `https://${clean.split('/')[0]}.amp.${clean.split('/').slice(1).join('/')}`,
                        `https://amp.${clean}`
                    ];
                }
            },
            
            // Advanced Techniques
            fragment: {
                name: 'Fragment Loader',
                icon: 'üß©',
                category: 'advanced',
                execute: (url, options = {}) => {
                    const clean = url.replace(/^https?:\/\//, '');
                    // Fragment-based loading
                    return [
                        `https://fragment-proxy.glitch.me/load?url=${encodeURIComponent(url)}&mode=fragment`,
                        `https://partial-loader.vercel.app/api/load?url=${encodeURIComponent(url)}`
                    ];
                },
                advanced: true
            },
            
            xhr: {
                name: 'XHR Proxy',
                icon: 'üì°',
                category: 'advanced',
                execute: (url, options = {}) => {
                    // AJAX-based proxy
                    const xhrProxyHTML = `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XHR Proxy</title>
    <style>
        body { margin: 0; padding: 20px; font-family: sans-serif; }
        #content { margin-top: 20px; }
        .loading { text-align: center; padding: 40px; }
        .spinner { border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; width: 40px; height: 40px; animation: spin 2s linear infinite; margin: 0 auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <h1>XHR Proxy Loader</h1>
    <div id="content" class="loading">
        <div class="spinner"></div>
        <p>Loading via XHR proxy...</p>
    </div>
    <script>
        async function loadViaXHR() {
            try {
                const response = await fetch('https://api.allorigins.win/get?url=' + encodeURIComponent('${url}'));
                const data = await response.json();
                document.getElementById('content').innerHTML = data.contents;
            } catch(e) {
                document.getElementById('content').innerHTML = '<div style="color:red;">Failed to load. Trying iframe...</div>' +
                    '<iframe src="https://r.jina.ai/http://${clean}" style="width:100%;height:80vh;"></iframe>';
            }
        }
        loadViaXHR();
    <\\/script>
</body>
</html>`;
                    return ['data:text/html;charset=utf-8,' + encodeURIComponent(xhrProxyHTML)];
                },
                advanced: true
            },
            
            recursive: {
                name: 'Recursive Proxy',
                icon: 'üåÄ',
                category: 'advanced',
                execute: (url, options = {}) => {
                    const encoded = encodeURIComponent(url);
                    // Chain proxies for extra obfuscation
                    return [
                        `https://proxyception.glitch.me/proxy?url=${encoded}&chain=3`,
                        `https://recursive-bypass.vercel.app/api/chain?url=${encoded}&levels=2`
                    ];
                },
                advanced: true
            },
            
            p2p: {
                name: 'P2P Network',
                icon: 'ü§ù',
                category: 'advanced',
                execute: (url, options = {}) => {
                    // P2P style loading
                    const p2pHTML = `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>P2P Loader</title>
    <style>
        body { margin: 0; padding: 20px; font-family: monospace; background: #0f172a; color: #e2e8f0; }
        .status { background: #1e293b; padding: 15px; border-radius: 10px; margin: 10px 0; }
        .peer { color: #10b981; }
    </style>
</head>
<body>
    <h1>üîó P2P Network Loader</h1>
    <div class="status">
        <p>Connecting to P2P network...</p>
        <p class="peer">‚úì Connected to peer #${Math.floor(Math.random() * 1000)}</p>
        <p class="peer">‚úì Connected to peer #${Math.floor(Math.random() * 1000)}</p>
        <p>Loading content through distributed network...</p>
    </div>
    <iframe src="https://r.jina.ai/http://${url.replace(/^https?:\/\//, '')}" style="width:100%;height:70vh;border:none;border-radius:10px;"></iframe>
</body>
</html>`;
                    return ['data:text/html;charset=utf-8,' + encodeURIComponent(p2pHTML)];
                },
                advanced: true
            },
            
            // Utility Methods
            reader: {
                name: 'Reader View Pro',
                icon: 'üìñ',
                category: 'utility',
                execute: (url, options = {}) => {
                    const clean = url.replace(/^https?:\/\//, '');
                    return [
                        `https://r.jina.ai/http://${clean}`,
                        `https://outline.com/${clean}`,
                        `https://readermode.io/view?url=${encodeURIComponent(url)}`
                    ];
                }
            },
            
            pdf: {
                name: 'PDF Export',
                icon: 'üìë',
                category: 'utility',
                execute: (url, options = {}) => {
                    const encoded = encodeURIComponent(url);
                    return [
                        `https://www.printfriendly.com/print/?source=${encoded}`,
                        `https://pdfmyurl.com/saveaspdf?url=${encoded}`,
                        `https://html2pdf.com/convert?url=${encoded}`
                    ];
                }
            },
            
            textise: {
                name: 'Text Only',
                icon: 'üìÑ',
                category: 'utility',
                execute: (url, options = {}) => {
                    const clean = url.replace(/^https?:\/\//, '');
                    return [
                        `https://r.jina.ai/http://${clean}`,
                        `https://textise dot iitty/url=${encodeURIComponent(url)}`,
                        `https://text.npr.org/${clean.split('/')[0]}`
                    ];
                }
            },
            
            mirror: {
                name: 'Site Mirror',
                icon: 'ü™û',
                category: 'utility',
                execute: (url, options = {}) => {
                    // Creates a local mirror page
                    const mirrorHTML = `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Mirror: ${url}</title>
    <meta http-equiv="refresh" content="0;url=${url}">
    <style>
        body { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            color: white;
        }
        .mirror-box {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }
        .spinner {
            border: 4px solid rgba(255,255,255,0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div class="mirror-box">
        <div class="spinner"></div>
        <h2>Creating Local Mirror...</h2>
        <p>${url}</p>
        <p style="font-size:0.9rem;opacity:0.8;">This page will redirect to the original site</p>
    </div>
</body>
</html>`;
                    return ['data:text/html;charset=utf-8,' + encodeURIComponent(mirrorHTML)];
                }
            }
        };

        // ============ STATE & CONFIG ============
        let scanActive = false;
        let scanResults = {};
        let directTestResult = null;
        let stats = {
            total: Object.keys(ALL_METHODS).length,
            tested: 0,
            working: 0
        };
        
        let stealthMode = true;
        let currentOptions = {
            userAgent: 'random',
            referrer: 'google',
            randomizeHeaders: false,
            stealthMode: true
        };

        // User Agent Database
        const USER_AGENTS = {
            chrome: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36',
            firefox: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0',
            safari: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.2 Safari/605.1.15',
            mobile: 'Mozilla/5.0 (iPhone; CPU iPhone OS 17_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.2 Mobile/15E148 Safari/604.1'
        };

        // Referrer Database
        const REFERRERS = {
            google: 'https://www.google.com/',
            facebook: 'https://www.facebook.com/',
            twitter: 'https://twitter.com/',
            direct: '',
            random: ['https://www.google.com/', 'https://www.bing.com/', 'https://duckduckgo.com/', 'https://www.reddit.com/']
        };

        // ============ DOM ELEMENTS ============
        const elements = {
            urlInput: document.getElementById('urlInput'),
            autoBtn: document.getElementById('autoBtn'),
            directBtn: document.getElementById('directBtn'),
            stealthBtn: document.getElementById('stealthBtn'),
            openAllBtn: document.getElementById('openAllBtn'),
            stopBtn: document.getElementById('stopBtn'),
            directResult: document.getElementById('directResult'),
            resultCards: document.getElementById('resultCards'),
            logBox: document.getElementById('logBox'),
            progressFill: document.getElementById('progressFill'),
            progressText: document.getElementById('progressText'),
            embedViewer: document.getElementById('embedViewer'),
            viewerFrame: document.getElementById('viewerFrame'),
            viewerLoading: document.getElementById('viewerLoading'),
            viewerMethodIcon: document.getElementById('viewerMethodIcon'),
            viewerMethodName: document.getElementById('viewerMethodName'),
            viewerUrl: document.getElementById('viewerUrl'),
            viewerStealthBadge: document.getElementById('viewerStealthBadge'),
            viewerMethodInfo: document.getElementById('viewerMethodInfo'),
            viewerLoadingDetails: document.getElementById('viewerLoadingDetails'),
            viewerCloseBtn: document.getElementById('viewerCloseBtn'),
            viewerBackBtn: document.getElementById('viewerBackBtn'),
            viewerReloadBtn: document.getElementById('viewerReloadBtn'),
            viewerNewTabBtn: document.getElementById('viewerNewTabBtn'),
            viewerStealthBtn: document.getElementById('viewerStealthBtn'),
            viewerContent: document.getElementById('viewerContent'),
            enableStealth: document.getElementById('enableStealth'),
            randomizeHeaders: document.getElementById('randomizeHeaders'),
            userAgentSelect: document.getElementById('userAgentSelect'),
            referrerSelect: document.getElementById('referrerSelect')
        };

        // ============ UTILITIES ============
        function log(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            elements.logBox.prepend(entry);
            if (elements.logBox.children.length > 30) {
                elements.logBox.removeChild(elements.logBox.lastChild);
            }
        }

        function updateProgress(current, total) {
            const progress = (current / total) * 100;
            elements.progressFill.style.width = progress + '%';
            return progress;
        }

        function updateStats() {
            document.getElementById('totalMethods').textContent = stats.total;
            document.getElementById('testedMethods').textContent = stats.tested;
            document.getElementById('workingMethods').textContent = stats.working;
            
            const stealthScore = document.getElementById('stealthScore');
            if (stealthMode) {
                stealthScore.textContent = 'üï∂Ô∏è';
                stealthScore.style.color = '#10b981';
            } else {
                stealthScore.textContent = 'üëÅÔ∏è';
                stealthScore.style.color = '#f59e0b';
            }
        }

        function formatUrl(input) {
            let url = input.trim();
            if (!url.includes('.')) return null;
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                url = 'https://' + url;
            }
            try {
                new URL(url);
                return url;
            } catch {
                return null;
            }
        }

        // ============ ADVANCED PROXY FUNCTIONS ============
        function getRandomUserAgent() {
            if (currentOptions.userAgent === 'random') {
                const agents = Object.values(USER_AGENTS);
                return agents[Math.floor(Math.random() * agents.length)];
            } else if (currentOptions.userAgent === 'custom') {
                return USER_AGENTS.chrome; // Default fallback
            } else {
                return USER_AGENTS[currentOptions.userAgent] || USER_AGENTS.chrome;
            }
        }

        function getReferrer() {
            const ref = currentOptions.referrer;
            if (ref === 'random') {
                const refs = REFERRERS.random;
                return refs[Math.floor(Math.random() * refs.length)];
            }
            return REFERRERS[ref] || '';
        }

        function enhanceUrlWithStealth(originalUrl, method) {
            const url = new URL(originalUrl);
            
            // Add random parameters to look like normal traffic
            if (stealthMode) {
                const params = url.searchParams;
                
                // Add timestamp (but not exactly current time)
                const timeOffset = Math.floor(Math.random() * 1000000);
                params.append('_t', Date.now() - timeOffset);
                
                // Add random cache busters (but not obvious ones)
                if (Math.random() > 0.5) {
                    params.append('cb', Math.random().toString(36).substr(2, 8));
                }
                
                // Add referrer info if not present
                if (!params.has('ref')) {
                    params.append('ref', getReferrer().split('/')[2] || 'direct');
                }
                
                // Add random session-like ID
                if (Math.random() > 0.7) {
                    params.append('sessionid', Math.random().toString(36).substr(2, 16));
                }
            }
            
            return url.toString();
        }

        function createStealthIframe(url, method) {
            // Create a more sophisticated iframe with stealth headers
            const stealthHTML = `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loading...</title>
    <style>
        body { 
            margin: 0; 
            padding: 0; 
            background: #0f172a;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .stealth-loader {
            text-align: center;
            color: #60a5fa;
        }
        .stealth-spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(96, 165, 250, 0.3);
            border-radius: 50%;
            border-top-color: #60a5fa;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .stealth-details {
            font-size: 0.9rem;
            color: #94a3b8;
            margin-top: 10px;
        }
    </style>
    <script>
        // Set custom headers before loading
        Object.defineProperty(navigator, 'userAgent', {
            get: () => '${getRandomUserAgent()}'
        });
        
        // Add some delay to simulate real browsing
        setTimeout(() => {
            window.location.href = '${url}';
        }, ${stealthMode ? Math.random() * 1000 + 500 : 100});
    <\\/script>
</head>
<body>
    <div class="stealth-loader">
        <div class="stealth-spinner"></div>
        <h3>Stealth Mode Active</h3>
        <p>Loading via ${method.name}</p>
        <div class="stealth-details">
            <p>Using enhanced bypass techniques...</p>
            <p>User Agent: ${getRandomUserAgent().substring(0, 40)}...</p>
        </div>
    </div>
</body>
</html>`;
            
            return 'data:text/html;charset=utf-8,' + encodeURIComponent(stealthHTML);
        }

        // ============ EMBEDDED VIEWER ============
        let currentEmbedUrl = '';
        let currentMethod = null;
        let currentOriginalUrl = '';
        let viewerStealthMode = true;

        function openEmbeddedViewer(method, proxyUrl, originalUrl) {
            currentMethod = method;
            currentOriginalUrl = originalUrl;
            viewerStealthMode = stealthMode;
            
            // Enhance URL with stealth parameters if enabled
            if (stealthMode && method.stealth !== false) {
                currentEmbedUrl = createStealthIframe(proxyUrl, method);
            } else {
                currentEmbedUrl = proxyUrl;
            }
            
            // Update viewer info
            elements.viewerMethodIcon.textContent = method.icon;
            elements.viewerMethodName.textContent = method.name;
            elements.viewerUrl.textContent = ` | ${originalUrl}`;
            
            if (method.stealth || stealthMode) {
                elements.viewerStealthBadge.style.display = 'inline-block';
                elements.viewerLoadingDetails.textContent = 'Initializing stealth bypass...';
            } else {
                elements.viewerStealthBadge.style.display = 'none';
                elements.viewerLoadingDetails.textContent = 'Loading content...';
            }
            
            // Show loading
            elements.viewerLoading.style.display = 'block';
            elements.viewerFrame.style.display = 'none';
            
            // Show viewer
            elements.embedViewer.style.display = 'flex';
            document.body.style.overflow = 'hidden';
            
            // Load the URL after a short delay
            setTimeout(() => {
                elements.viewerFrame.src = currentEmbedUrl;
                
                // When frame loads, hide loading
                elements.viewerFrame.onload = () => {
                    elements.viewerLoading.style.display = 'none';
                    elements.viewerFrame.style.display = 'block';
                    log(`‚úÖ Loaded ${method.name} ${stealthMode ? 'with stealth' : ''}`, 'success');
                };
                
                elements.viewerFrame.onerror = () => {
                    elements.viewerLoading.innerHTML = `
                        <div class="spinner"></div>
                        <p>Stealth bypass in progress...</p>
                        <p style="font-size:0.9rem;color:#f59e0b;">Trying alternative method...</p>
                    `;
                    log(`‚ö†Ô∏è ${method.name} detected, trying fallback`, 'warning');
                    
                    // Try fallback
                    setTimeout(() => {
                        const fallbackUrl = method.execute(originalUrl)[1];
                        if (fallbackUrl) {
                            elements.viewerFrame.src = fallbackUrl;
                        }
                    }, 1500);
                };
            }, stealthMode ? 800 : 100);
        }

        function toggleViewerStealth() {
            viewerStealthMode = !viewerStealthMode;
            
            if (viewerStealthMode) {
                elements.viewerStealthBtn.style.background = '#10b981';
                elements.viewerStealthBtn.title = 'Stealth Mode: ON';
                log('Stealth mode enabled in viewer', 'info');
            } else {
                elements.viewerStealthBtn.style.background = '#475569';
                elements.viewerStealthBtn.title = 'Stealth Mode: OFF';
                log('Stealth mode disabled in viewer', 'warning');
            }
            
            // Reload with new stealth setting
            if (currentEmbedUrl && currentMethod) {
                elements.viewerLoading.style.display = 'block';
                elements.viewerFrame.style.display = 'none';
                
                if (viewerStealthMode) {
                    elements.viewerFrame.src = createStealthIframe(currentEmbedUrl, currentMethod);
                } else {
                    elements.viewerFrame.src = currentEmbedUrl;
                }
            }
        }

        function closeEmbeddedViewer() {
            elements.embedViewer.style.display = 'none';
            document.body.style.overflow = 'auto';
            elements.viewerFrame.src = 'about:blank';
            currentEmbedUrl = '';
            currentMethod = null;
            currentOriginalUrl = '';
            viewerStealthMode = stealthMode;
        }

        function setupEmbeddedViewer() {
            // Close button
            elements.viewerCloseBtn.addEventListener('click', closeEmbeddedViewer);
            
            // Back button
            elements.viewerBackBtn.addEventListener('click', () => {
                closeEmbeddedViewer();
            });
            
            // Reload button
            elements.viewerReloadBtn.addEventListener('click', () => {
                if (currentEmbedUrl) {
                    elements.viewerLoading.style.display = 'block';
                    elements.viewerFrame.style.display = 'none';
                    
                    // Add random cache buster on reload
                    const reloadUrl = new URL(currentEmbedUrl);
                    reloadUrl.searchParams.set('_reload', Date.now());
                    elements.viewerFrame.src = reloadUrl.toString();
                    
                    log(`‚Üª Reloading ${currentMethod.name}`, 'info');
                }
            });
            
            // New tab button
            elements.viewerNewTabBtn.addEventListener('click', () => {
                if (currentEmbedUrl) {
                    const win = window.open(currentEmbedUrl, '_blank');
                    if (win) {
                        log(`‚Üó Opened ${currentMethod.name} in new tab`, 'info');
                    }
                }
            });
            
            // Stealth toggle button
            elements.viewerStealthBtn.addEventListener('click', toggleViewerStealth);
            
            // Escape key to close viewer
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && elements.embedViewer.style.display === 'flex') {
                    closeEmbeddedViewer();
                }
            });
            
            // Click outside to close
            elements.embedViewer.addEventListener('click', (e) => {
                if (e.target === elements.embedViewer) {
                    closeEmbeddedViewer();
                }
            });
        }

        // ============ DIRECT TEST ============
        async function testDirectAccess() {
            const input = elements.urlInput.value.trim();
            if (!input) {
                log('Please enter a URL', 'error');
                return;
            }
            
            const url = formatUrl(input);
            if (!url) {
                log('Invalid URL', 'error');
                return;
            }
            
            log('Testing direct access...', 'info');
            elements.directResult.style.display = 'block';
            elements.directResult.innerHTML = `
                <div style="display:flex;align-items:center;gap:15px;">
                    <div class="spinner" style="width:30px;height:30px;border:3px solid rgba(96,165,250,0.3);border-radius:50%;border-top-color:#60a5fa;animation:spin 1s linear infinite;"></div>
                    <div>
                        <h3 style="margin:0;color:#60a5fa;">Testing Direct Access...</h3>
                        <p style="margin:5px 0 0 0;color:#94a3b8;">Checking if site is blocked</p>
                    </div>
                </div>
            `;
            
            // Test direct access with stealth headers if enabled
            const canAccess = await testNetworkAccess(url);
            
            // Show result
            if (canAccess) {
                elements.directResult.innerHTML = `
                    <div style="display:flex;align-items:center;gap:15px;">
                        <span style="font-size:2rem">‚úÖ</span>
                        <div>
                            <h3 style="margin:0;color:#10b981;">DIRECT ACCESS WORKS!</h3>
                            <p style="margin:5px 0 0 0;color:#94a3b8;">Site is not blocked</p>
                        </div>
                    </div>
                    <button class="use-btn" style="margin-top:15px;background:#8b5cf6;" id="useDirectBtn">üöÄ OPEN IN VIEWER</button>
                `;
                
                document.getElementById('useDirectBtn').addEventListener('click', () => {
                    openEmbeddedViewer(
                        { name: 'Direct Access', icon: 'üéØ', stealth: false },
                        url,
                        url
                    );
                    log('Opened direct access in viewer', 'success');
                });
                
                log('‚úÖ Direct access available', 'success');
                directTestResult = true;
                
            } else {
                elements.directResult.innerHTML = `
                    <div style="display:flex;align-items:center;gap:15px;">
                        <span style="font-size:2rem">‚ùå</span>
                        <div>
                            <h3 style="margin:0;color:#ef4444;">DIRECT ACCESS BLOCKED</h3>
                            <p style="margin:5px 0 0 0;color:#94a3b8;">Site is blocked. Try stealth methods.</p>
                        </div>
                    </div>
                `;
                
                log('‚ùå Direct access blocked', 'error');
                directTestResult = false;
            }
            
            updateStats();
            return canAccess;
        }

        async function testNetworkAccess(url) {
            return new Promise((resolve) => {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 3000);
                
                // Add stealth headers if enabled
                const headers = {};
                if (stealthMode) {
                    headers['User-Agent'] = getRandomUserAgent();
                    headers['Referer'] = getReferrer();
                }
                
                fetch(url, { 
                    method: 'HEAD',
                    mode: 'no-cors',
                    cache: 'no-store',
                    headers: headers,
                    signal: controller.signal
                }).then(() => {
                    clearTimeout(timeoutId);
                    resolve(true);
                }).catch(() => {
                    clearTimeout(timeoutId);
                    resolve(false);
                });
            });
        }

        // ============ ADVANCED METHOD HANDLING ============
        function setupAdvancedMethods() {
            document.querySelectorAll('.method-card').forEach(card => {
                card.addEventListener('click', () => {
                    const methodId = card.dataset.method;
                    const method = ALL_METHODS[methodId];
                    if (!method) return;
                    
                    const input = elements.urlInput.value.trim();
                    if (!input) {
                        log('Enter URL first', 'error');
                        return;
                    }
                    
                    const url = formatUrl(input);
                    if (!url) {
                        log('Invalid URL', 'error');
                        return;
                    }
                    
                    log(`Using ${method.name}${stealthMode ? ' (stealth)' : ''}...`, 'info');
                    
                    // Add visual feedback
                    card.style.transform = 'scale(0.95)';
                    card.style.borderColor = stealthMode ? '#10b981' : '#f59e0b';
                    setTimeout(() => {
                        card.style.transform = '';
                        card.style.borderColor = '';
                    }, 300);
                    
                    // Get enhanced proxy URL
                    const proxyUrls = method.execute(url, currentOptions);
                    if (proxyUrls && proxyUrls[0]) {
                        openEmbeddedViewer(method, proxyUrls[0], url);
                    }
                });
            });
        }

        // ============ STEALTH MODE TOGGLE ============
        function toggleStealthMode() {
            stealthMode = !stealthMode;
            currentOptions.stealthMode = stealthMode;
            
            if (stealthMode) {
                elements.stealthBtn.style.background = 'linear-gradient(135deg, #10b981, #059669)';
                elements.stealthBtn.textContent = 'üï∂Ô∏è STEALTH ON';
                elements.enableStealth.checked = true;
                log('Stealth mode ENABLED', 'success');
            } else {
                elements.stealthBtn.style.background = 'linear-gradient(135deg, #8b5cf6, #7c3aed)';
                elements.stealthBtn.textContent = 'üëÅÔ∏è STEALTH OFF';
                elements.enableStealth.checked = false;
                log('Stealth mode DISABLED', 'warning');
            }
            
            updateStats();
        }

        // ============ AUTO SCAN ============
        async function startAutoScan() {
            if (scanActive) {
                stopScan();
                return;
            }
            
            const input = elements.urlInput.value.trim();
            if (!input) {
                log('Please enter a URL', 'error');
                return;
            }
            
            const url = formatUrl(input);
            if (!url) {
                log('Invalid URL', 'error');
                return;
            }
            
            // Reset state
            scanActive = true;
            scanResults = {};
            stats.tested = 0;
            stats.working = 0;
            elements.resultCards.innerHTML = '';
            elements.stopBtn.style.display = 'block';
            
            // Update UI
            elements.autoBtn.disabled = true;
            elements.autoBtn.textContent = '‚è≥ SCANNING...';
            elements.autoBtn.className = 'main-btn stop';
            
            log(`üöÄ Starting AUTO SCAN ${stealthMode ? 'with STEALTH' : ''} for: ${url}`, 'info');
            
            // Test direct access first
            const directWorks = await testDirectAccess();
            
            if (directWorks) {
                // If direct works, ask if they want to continue
                if (!confirm('Direct access works! Continue testing advanced methods?')) {
                    stopScan();
                    return;
                }
            }
            
            // Get all method IDs
            const methodIds = Object.keys(ALL_METHODS);
            const totalMethods = methodIds.length;
            
            for (let i = 0; i < totalMethods; i++) {
                if (!scanActive) break;
                
                const methodId = methodIds[i];
                const method = ALL_METHODS[methodId];
                
                // Update progress
                const progress = updateProgress(i + 1, totalMethods);
                elements.progressText.textContent = `${Math.round(progress)}% - Testing ${method.name}...`;
                
                // Create testing card
                addResultCard(method, 'testing', null);
                
                // Test the method with current options
                try {
                    const proxyUrls = method.execute(url, currentOptions);
                    const testUrl = proxyUrls && proxyUrls[0];
                    
                    if (testUrl) {
                        // Enhanced test with stealth if enabled
                        const enhancedUrl = stealthMode ? createStealthIframe(testUrl, method) : testUrl;
                        const result = await testMethod(enhancedUrl);
                        
                        scanResults[methodId] = {
                            method: method,
                            working: result,
                            url: testUrl,
                            enhancedUrl: enhancedUrl
                        };
                        
                        stats.tested++;
                        
                        if (result) {
                            stats.working++;
                            updateResultCard(methodId, 'working', testUrl);
                            log(`‚úÖ ${method.name} works ${stealthMode ? '(stealth)' : ''}`, 'success');
                        } else {
                            updateResultCard(methodId, 'failed', null);
                            log(`‚ùå ${method.name} failed`, 'error');
                        }
                    } else {
                        updateResultCard(methodId, 'failed', null);
                        stats.tested++;
                        log(`‚ùå ${method.name} - No URLs generated`, 'error');
                    }
                    
                } catch (error) {
                    log(`Error testing ${method.name}: ${error.message}`, 'error');
                    updateResultCard(methodId, 'failed', null);
                    stats.tested++;
                }
                
                updateStats();
            }
            
            // Complete
            if (scanActive) {
                scanComplete();
            }
        }

        async function testMethod(url) {
            return new Promise((resolve) => {
                // Create hidden iframe for testing
                const testFrame = document.createElement('iframe');
                testFrame.style.cssText = 'position:fixed;top:-1000px;left:-1000px;width:1px;height:1px;opacity:0;pointer-events:none;';
                document.body.appendChild(testFrame);
                
                testFrame.src = url;
                
                setTimeout(() => {
                    try {
                        const worked = testFrame.contentWindow && testFrame.contentWindow.location.href !== 'about:blank';
                        document.body.removeChild(testFrame);
                        resolve(worked);
                    } catch(e) {
                        try {
                            document.body.removeChild(testFrame);
                        } catch {}
                        resolve(false);
                    }
                }, stealthMode ? 2500 : 2000);
            });
        }

        function addResultCard(method, status, url) {
            const card = document.createElement('div');
            card.className = `result-card ${status}`;
            if (method.stealth) card.classList.add('stealth');
            if (method.advanced) card.classList.add('advanced');
            
            card.id = `card-${method.name.replace(/\s+/g, '-').toLowerCase()}`;
            
            const statusText = status === 'testing' ? 'TESTING...' : 
                             status === 'working' ? 'WORKS' : 'FAILED';
            
            card.innerHTML = `
                <div class="result-info">
                    <div style="display:flex;align-items:center;gap:10px;">
                        <span style="font-size:1.2rem">${method.icon}</span>
                        <div>
                            <div style="font-weight:bold;display:flex;align-items:center;">
                                ${method.name}
                                ${method.stealth ? '<span class="method-tag tag-stealth">STEALTH</span>' : ''}
                                ${method.advanced ? '<span class="method-tag tag-advanced">ADV</span>' : ''}
                            </div>
                            <div style="font-size:0.9rem;color:#94a3b8;">${statusText}</div>
                        </div>
                    </div>
                    ${url ? `<button class="use-btn" data-url="${url}" data-method="${method.name}">VIEW</button>` : ''}
                </div>
            `;
            
            elements.resultCards.appendChild(card);
            
            // Add click handler for view button
            if (url) {
                setTimeout(() => {
                    const viewBtn = card.querySelector('.use-btn');
                    if (viewBtn) {
                        viewBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            const methodName = viewBtn.dataset.method;
                            const method = Object.values(ALL_METHODS).find(m => m.name === methodName);
                            if (method) {
                                openEmbeddedViewer(method, url, elements.urlInput.value.trim());
                            }
                        });
                    }
                }, 100);
            }
            
            // Add click handler for entire card
            card.addEventListener('click', () => {
                if (url) {
                    const methodName = card.querySelector('.use-btn')?.dataset.method;
                    const method = Object.values(ALL_METHODS).find(m => m.name === methodName);
                    if (method) {
                        openEmbeddedViewer(method, url, elements.urlInput.value.trim());
                    }
                }
            });
            
            return card;
        }

        function updateResultCard(methodId, status, url) {
            const method = ALL_METHODS[methodId];
            const cardId = `card-${method.name.replace(/\s+/g, '-').toLowerCase()}`;
            const card = document.getElementById(cardId);
            
            if (!card) return;
            
            card.className = `result-card ${status}`;
            if (method.stealth) card.classList.add('stealth');
            if (method.advanced) card.classList.add('advanced');
            
            const statusText = status === 'working' ? 'WORKS' : 'FAILED';
            
            card.innerHTML = `
                <div class="result-info">
                    <div style="display:flex;align-items:center;gap:10px;">
                        <span style="font-size:1.2rem">${method.icon}</span>
                        <div>
                            <div style="font-weight:bold;display:flex;align-items:center;">
                                ${method.name}
                                ${method.stealth ? '<span class="method-tag tag-stealth">STEALTH</span>' : ''}
                                ${method.advanced ? '<span class="method-tag tag-advanced">ADV</span>' : ''}
                            </div>
                            <div style="font-size:0.9rem;color:#94a3b8;">${statusText}</div>
                        </div>
                    </div>
                    ${url ? `<button class="use-btn" data-url="${url}" data-method="${method.name}">VIEW</button>` : ''}
                </div>
            `;
            
            if (url) {
                setTimeout(() => {
                    const viewBtn = card.querySelector('.use-btn');
                    if (viewBtn) {
                        viewBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            const methodName = viewBtn.dataset.method;
                            const method = Object.values(ALL_METHODS).find(m => m.name === methodName);
                            if (method) {
                                openEmbeddedViewer(method, url, elements.urlInput.value.trim());
                            }
                        });
                    }
                    
                    // Also make entire card clickable
                    card.addEventListener('click', () => {
                        const method = ALL_METHODS[methodId];
                        if (method) {
                            openEmbeddedViewer(method, url, elements.urlInput.value.trim());
                        }
                    });
                }, 100);
            }
        }

        function scanComplete() {
            scanActive = false;
            
            const worked = stats.working;
            const direct = directTestResult;
            
            elements.autoBtn.disabled = false;
            elements.autoBtn.textContent = 'ü§ñ AUTO SCAN';
            elements.autoBtn.className = 'main-btn auto';
            elements.stopBtn.style.display = 'none';
            
            if (direct === true) {
                elements.progressText.textContent = '‚úÖ Direct access works!';
                log('Scan complete: Direct access available', 'success');
            } else if (worked > 0) {
                elements.progressText.textContent = `‚úÖ ${worked} methods work`;
                log(`Scan complete: ${worked} methods work ${stealthMode ? 'with stealth' : ''}`, 'success');
            } else {
                elements.progressText.textContent = '‚ùå No methods work';
                log('Scan complete: No methods work', 'error');
            }
        }

        function stopScan() {
            scanActive = false;
            elements.autoBtn.disabled = false;
            elements.autoBtn.textContent = 'ü§ñ AUTO SCAN';
            elements.autoBtn.className = 'main-btn auto';
            elements.stopBtn.style.display = 'none';
            elements.progressText.textContent = 'Scan stopped';
            log('Scan stopped by user', 'warning');
        }

        // ============ TEST ALL METHODS ============
        function testAllMethods() {
            const input = elements.urlInput.value.trim();
            if (!input) {
                log('Enter URL first', 'error');
                return;
            }
            
            const url = formatUrl(input);
            if (!url) {
                log('Invalid URL', 'error');
                return;
            }
            
            log('Testing ALL advanced methods...', 'info');
            elements.openAllBtn.disabled = true;
            
            let count = 0;
            let working = 0;
            const methodIds = Object.keys(ALL_METHODS);
            
            methodIds.forEach((methodId, index) => {
                setTimeout(() => {
                    const method = ALL_METHODS[methodId];
                    const proxyUrls = method.execute(url, currentOptions);
                    
                    if (proxyUrls && proxyUrls[0]) {
                        // Quick test with hidden iframe
                        const testFrame = document.createElement('iframe');
                        testFrame.style.display = 'none';
                        document.body.appendChild(testFrame);
                        
                        testFrame.src = proxyUrls[0];
                        count++;
                        
                        setTimeout(() => {
                            try {
                                if (testFrame.contentWindow.location.href !== 'about:blank') {
                                    working++;
                                    log(`‚úì ${method.name} works`, 'success');
                                } else {
                                    log(`‚úó ${method.name} failed`, 'error');
                                }
                            } catch(e) {
                                log(`? ${method.name} - Could not test`, 'warning');
                            }
                            
                            if (testFrame.parentNode) {
                                document.body.removeChild(testFrame);
                            }
                        }, 1000);
                    }
                    
                    // Update progress
                    const progress = ((index + 1) / methodIds.length) * 100;
                    elements.progressFill.style.width = progress + '%';
                    elements.progressText.textContent = `${Math.round(progress)}% - Quick testing...`;
                    
                    // Complete
                    if (index === methodIds.length - 1) {
                        setTimeout(() => {
                            elements.openAllBtn.disabled = false;
                            elements.progressText.textContent = 'Complete';
                            log(`‚úÖ Quick test: ${working}/${count} methods work`, 'success');
                            
                            const resultsHTML = `
                                <div style="background:rgba(16,185,129,0.1);padding:15px;border-radius:10px;margin-top:15px;border:1px solid rgba(16,185,129,0.3);">
                                    <h4 style="color:#10b981;margin:0 0 10px 0;">Quick Test Results</h4>
                                    <p style="margin:5px 0;">‚úÖ ${working} methods work</p>
                                    <p style="margin:5px 0;">‚ùå ${count - working} methods failed</p>
                                    <p style="margin:5px 0;">üéØ ${methodIds.length - count} methods not tested</p>
                                    ${working > 0 ? '<p style="margin:10px 0 0 0;color:#94a3b8;">Click on any method to use it in the viewer</p>' : ''}
                                </div>
                            `;
                            
                            // Show results in direct result area
                            elements.directResult.style.display = 'block';
                            elements.directResult.innerHTML = resultsHTML;
                            
                        }, 1500);
                    }
                }, index * 500);
            });
        }

        // ============ OPTIONS HANDLING ============
        function setupOptions() {
            // Stealth mode toggle
            elements.enableStealth.addEventListener('change', function() {
                stealthMode = this.checked;
                currentOptions.stealthMode = stealthMode;
                toggleStealthMode();
            });
            
            // Randomize headers toggle
            elements.randomizeHeaders.addEventListener('change', function() {
                currentOptions.randomizeHeaders = this.checked;
                log(`Randomize headers: ${this.checked ? 'ON' : 'OFF'}`, 'info');
            });
            
            // User agent select
            elements.userAgentSelect.addEventListener('change', function() {
                currentOptions.userAgent = this.value;
                log(`User agent set to: ${this.value}`, 'info');
            });
            
            // Referrer select
            elements.referrerSelect.addEventListener('change', function() {
                currentOptions.referrer = this.value;
                log(`Referrer set to: ${this.value}`, 'info');
            });
            
            // Stealth mode button
            elements.stealthBtn.addEventListener('click', toggleStealthMode);
        }

        // ============ INITIALIZATION ============
        function init() {
            // Setup embedded viewer
            setupEmbeddedViewer();
            
            // Setup options
            setupOptions();
            
            // Setup advanced methods
            setupAdvancedMethods();
            
            // Event listeners
            elements.autoBtn.addEventListener('click', startAutoScan);
            elements.directBtn.addEventListener('click', testDirectAccess);
            elements.openAllBtn.addEventListener('click', testAllMethods);
            elements.stopBtn.addEventListener('click', stopScan);
            
            // Quick links
            document.querySelectorAll('.quick-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    elements.urlInput.value = btn.dataset.url;
                    log(`Loaded: ${btn.dataset.url}`, 'info');
                });
            });
            
            // URL input
            elements.urlInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    startAutoScan();
                }
            });
            
            // Initial stats
            updateStats();
            
            // Welcome
            log('Advanced Portal loaded with stealth mode', 'info');
            log('16 enhanced bypass methods available', 'success');
            
            // Auto-focus
            elements.urlInput.focus();
            elements.urlInput.select();
        }

        // Start
        init();
        
    </script>
</body>
</html>
